= Penetration Testing Tools by phases
Doc Writer <ssharif@secunoid.com>
v1.21.12.27.01
:numbered:
:sectnum:
:sectnumlevels: 6
:chapter-label:
:toc: right
:toclevels: 6
:docinfo:
:docinfo1:
:docinfo2:
:description: This document covers penetration testing tools
:keywords: information security, cyber security, penetration testing, pen testing
:imagesdir: images
:stylesheet:
:homepage: https://www.secunoid.com
'''


<<<
== Author
https://www.linkedin.com/in/shahidsharif[Shahid Sharif]

== Overview
This document covers penetration testing tools

<<<
==== Penetration Testing Methodology & Tools

===== Documentation
====== CherryTree
Chery Tree is a note taking app

===== Reconnaissance
. Open Source Intelligence Gathering
.. Look for sub-domains:

	sublist3r -d <domainname> -t3 -o <filename.txt>

.. Look for sub-domains, users, etc:

	theharvester -d <domainname> -b all -f <outputfilename>

. Discovery Scan

	nmap -sC -sV -oA foldername/filename IPAddress
	nmap -sC -sV -oA foldername/filename -iL <inputfilename>

. Recon scan all ports
	
	nmap -p- -v -oA foldername/filename-allports IPAddress

. If webservers are found perform web server enumeration:

	dirb -d <domainname> 
	gobuster 

. Take notes of all the findings and also include screen captures. 

======= Open Source Intelligence (OSINT)

======== Search Engines

image::SearchEnginesForSecurityProfessionals.jpg[Best Search Engines for Security Professionals and Pen Testers] 

======== Katana
https://github.com/adnane-X-tebbaa/Katana[Katana-ds] (ds for dork_scanner) is a simple python tool that automates Google Hacking/Dorking and support Tor
It becomes a more powerfull in combination with https://www.exploit-db.com/google-hacking-database[GHDB]

======= Metabigor
Metabigor is Intelligence tool, its goal is to do OSINT tasks and more but without any API key.

Link: https://www.kitploit.com/2020/02/metabigor-intelligence-tool-but-without.html

======== Maltego

======== Maryam
OWASP Maryam is an Open-source intelligence(OSINT) and Web-based Footprinting modular framework BASED on The Recon-ng and written in Python.
Link: https://www.owasp.org/index.php/OWASP_Maryam_Project 

======== OSI.IG
https://github.com/th3unkn0n/osi.ig [Instagram OSINT Tool] gets a range of information from an Instagram account that you normally wouldn't be able to get from just looking at their profile

The information includes:

* [ profile ] : user id, followers / following, number of uploads, profile img URL, business enum, external URL, joined Recently, etc
* [ tags & mentions ] : most used hashtags and mentioned accounts
* [ email ] : if any email is used any where it'll be displayed
* [ posts ] : accessability caption, location, timestamp, caption, picture url, etc

======== Recon_Spider
https://github.com/Aravindha1234u/Recon_Spider[Recon_Spider] scrapes social media account details from Instagram, Facebook and Twitter. It can find details about Phone number, Email data Breach.
Domain module has various scans for domain check for vulnerability and spider crawlers
Metadata Analyser
Reverse Image Search
IP Heatmap generator
Mac Address finder of manufacturer
IP2Proxy checks whether provided ip uses any kind of Proxy/VPN if any then check for DNSLeaks
Torrent Download History
Tool is currently available only in Command Line Interface (CLI)

Its public to use with your own api keys

======== Shodan
. Shodan is a search engine for devices connected to internet

===== Footprinting

====== Bloodhound
https://github.com/BloodHoundAD/Bloodhound/wiki[BloodHound] is a single page Javascript web application, built on top of Linkurious, compiled with Electron, with a Neo4j database fed by a PowerShell/C# ingestor.

BloodHound uses graph theory to reveal the hidden and often unintended relationships within an Active Directory environment. Attacks can use BloodHound to easily identify highly complex attack paths that would otherwise be impossible to quickly identify. Defenders can use BloodHound to identify and eliminate those same attack paths. Both blue and red teams can use BloodHound to easily gain a deeper understanding of privilege relationships in an Active Directory environment.

BloodHound is developed by @_wald0, @CptJesus, and @harmj0y.


====== Masscan
https://github.com/robertdavidgraham/masscan[MASSCAN] is an Internet-scale port scanner. It can scan the entire Internet in under 6 minutes, transmitting 10 million packets per second, from a single machine.

It's input/output is similar to nmap, the most famous port scanner. When in doubt, try one of those features.

Internally, it uses asynchronous transmissions, similar to port scanners like scanrand, unicornscan, and ZMap. It's more flexible, allowing arbitrary port and address ranges.

NOTE: masscan uses a its own custom TCP/IP stack. Anything other than simple port scans may cause conflict with the local TCP/IP stack. This means you need to either the --src-ip option to run from a different IP address, or use --src-port to configure which source ports masscan uses, then also configure the internal firewall (like pf or iptables) to firewall those ports from the rest of the operating system.

====== NESSUS

http://www.hackandtinker.net/2013/10/16/how-to-install-setup-and-use-nessus-on-kali/[Install Instructions]

====== NMAP

====== DIRB

DIRB is a Web Content Scanner. It looks for existing (and/or hidden) Web Objects. It basically works by launching a dictionary based attack against a web server and analyzing the response.

DIRB comes with a set of pre-configured attack wordlists for easy usage but you can use your custom wordlists. Also DIRB sometimes can be used as a classic CGI scanner, but remember is a content scanner not a vulnerability scanner.

DIRB main purpose is to help in professional web application auditing. Specially in security related testing. It covers some holes not covered by classic web vulnerability scanners. DIRB looks for specific web objects that other generic CGI scanners can’t look for. It doesn’t search vulnerabilities nor does it look for web contents that can be vulnerable.

Source: http://dirb.sourceforge.net/about.html
DIRB Homepage | Kali DIRB Repo

Author: The Dark Raver
License: GPLv2

https://tools.kali.org/web-applications/dirb 

====== Dirbuster

===== Reconnaissance
Combining the information gathered from OSINT and Footprinting activities.  This leads to finding vulnerabilities, exploiting them, lateral movement, persistence.

====== Admin-scanner
https://github.com/alienwhatever/Admin-Scanner[Admin-Scanner] - This Tool Is Design To Find Admin Panel Of Any Website By Using Custom Wordlist Or Default Wordlist Easily

===== Payload Delivery



====== Cryptcat
https://tools.kali.org/maintaining-access/cryptcat[CryptCat] is a simple Unix utility which reads and writes data across network connections, using TCP or UDP protocol while encrypting the data being transmitted. It is designed to be a reliable “back-end” tool that can be used directly or easily driven by other programs and scripts. At the same time, it is a feature-rich network debugging and exploration tool, since it can create almost any kind of connection you would need and has several interesting built-in capabilities.

===== Netcat

nc -lvnp 9001

===== Exploitation

====== Arpspoof

====== Burp Suite
Burp Suite is a web application testing tool

Use vulnerable web application from the OWASP site: https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project/Pages/Offline  

====== Cookie Crimes

If you steal someone’s Chrome cookies, you can log in to their accounts on every website they’re logged in to.

Normally you need the user’s password to do it, but I found a way to do it without the password. You just need to be able to execute code on their computer. It works by using Chrome’s Remote Debugging Protocol.

Link: https://github.com/defaultnamehere/cookie_crimes

===== Post-Exploitation

====== Crackmapexec
CrackMapExec (a.k.a CME) is a post-exploitation tool that helps automate assessing the security of large Active Directory networks. Built with stealth in mind, CME follows the concept of "Living off the Land": abusing built-in Active Directory features/protocols to achieve it's functionality and allowing it to evade most endpoint protection/IDS/IPS solutions.

Link: https://github.com/byt3bl33d3r/CrackMapExec

Usage:
	crackmapexec smb <IP Of Domain Controller> -u <username> -p '<password>'

====== PoshC2
https://www.hackingarticles.in/command-control-poshc2/[PoshC2] is an open-source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in PowerShell. Although PoshC2 primarily focuses on Windows implantation, it does contain a basic Python dropper for Linux/macOS.


===== Lateral Movement

===== Persistence

===== Chisel





===== DNSCAT
DNScat is such praised tool because it can create a command and control tunnel over the DNS protocol which lets an attacker work in stealth mode. You can access any data along with uploading and downloading files and to get a shell. For this tool to work over 53 port, you don’t need to have authoritative access to DNS server, you can just simply establish your connection over port 53 and it will be faster and it will still be sensed as usual traffic. But it makes its presence well known in the packet log.

DNScat is made of two components i.e. a server and a client. To know the working of dnscat, it is important to understand both of these components.

The client is intended to be kept running on a target machine. It’s written in C and has the least amount of the prerequisites. When you run the client, you regularly indicate a domain name. All packets will be sent to the local DNS server, which is then directed to the legitimate DNS server for that domain (which you, apparently, have control of).

The server is intended to be kept running on a definitive DNS server. It’s developed in ruby and relies upon a few distinct gems. When you run it, much like the client, you indicate from which domain(s) it listens to over 53. When it gets traffic for one of those domains, it endeavours to set up a legitimate association. It gets other traffic it will automatically disregard it but, however, it can also advance it upstream.
Link: https://www.hackingarticles.in/dnscat2-command-and-control-over-the-dns/?

===== DNSSPOOF

===== Empire
Empire 3.0 is a post-exploitation framework that includes a pure-PowerShell 2.0 Windows agent, and compatibility with Python 2.x/3.x Linux/OS X agents. It is the merger of the previous PowerShell Empire and Python EmPyre projects. The framework offers cryptologically-secure communications and a flexible architecture. On the PowerShell side, Empire implements the ability to run PowerShell agents without needing powershell.exe, rapidly deployable post-exploitation modules ranging from key loggers to Mimikatz, and adaptable communications to evade network detection, all wrapped up in a usability-focused framework. PowerShell Empire premiered at BSidesLV in 2015 and Python EmPyre premeiered at HackMiami 2016. BC-Security presented updates to further evade Microsoft Antimalware Scan Interface (AMSI) and JA3/S signatures at DEF CON 27.

Empire relies heavily on the work from several other projects for its underlying functionality. We have tried to call out a few of those people we've interacted with heavily here and have included author/reference link information in the source of each Empire module as appropriate. If we have failed to properly cite existing or prior work, please let us know at Empire@BC-Security.org.

Empire is developed by @harmj0y, @sixdub, @enigma0x3, @rvrsh3ll, @killswitch_gui, @xorrior, and @bcsecurity1. While the main fork for Empire is no longer maintained, this fork is maintained by BC-Security and will continue to receive periodic updates.

https://github.com/BC-SECURITY/Empire/ 

===== Ettercap

===== Exiftool
Shows exif data about a file.   To ensure you get the correct date time meta data, always use wget.

===== Eyewitness

===== Evilarc
evilarc.py is an archiving tool that allows for folder manipulation.

===== FatRat
TheFatRat by Edo Maland, is a massive exploiting tool which compiles a malware with famous payloads, generate backdoor that allows easy post exploitation attacks such as browser attacks etc.. and then the compiled maware can be executed on Linux , Windows , Mac and Android. TheFatRat Provides An Easy way to create Backdoors and Payload which can bypass most anti-virus.

Link: https://www.blackhatethicalhacking.com/tools/thefatrat/


===== Ghidra
Ghidra is a software reverse engineering (SRE) framework created and maintained by the National Security Agency Research Directorate. This framework includes a suite of full-featured, high-end software analysis tools that enable users to analyze compiled code on a variety of platforms including Windows, macOS, and Linux. Capabilities include disassembly, assembly, decompilation, graphing, and scripting, along with hundreds of other features. Ghidra supports a wide variety of processor instruction sets and executable formats and can be run in both user-interactive and automated modes. Users may also develop their own Ghidra plug-in components and/or scripts using Java or Python.
Link: https://ghidra-sre.org/

===== Gitleaks

Link: https://github.com/zricethezav/gitleaks

===== Gobuster

Gobuster is a tool used to brute-force:

* URIs (directories and files) in web sites.
* DNS subdomains (with wildcard support).

Install

	sudo apt-get install gobuster

Usage

Scan a website (-u http://192.168.0.155/) for directories using a wordlist (-w /usr/share/wordlists/dirb/common.txt) and print the full URLs of discovered paths (-e):

	*Using dirb word lists* gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirb/common.txt -o filename.txt
	*Using dirbuster word lists* gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirbuster/directgory-list-2.3-medium.txt -o filename.txt
	*Using a cookie* gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirbuster/directgory-list-2.3-medium.txt -o filename.txt -c 'cookievariable=valie'


[horizontal]
Source:: https://github.com/OJ/gobuster
Author:: OJ Reeves
License:: Apache-2.0
Syntax:: gobuster dir -u http://<site-name or IP address>/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o dirbust-root.log

===== Hashcat

===== HTTPROBE
[horizontal]
Github:: https://github.com/tomnomnom/httprobe
Perform a scan on specific ports:: cat domains.txt | httprobe -s -p https:8443


===== Hydra

===== Impacket-secretsdump

===== JQ
jq is like sed for JSON data - you can use it to slice and filter and map and transform structured data with the same ease that sed, awk, grep and friends let you play with text.

jq is written in portable C, and it has zero runtime dependencies. You can download a single binary, scp it to a far away machine of the same type, and expect it to work.

jq can mangle the data format that you have into the one that you want with very little effort, and the program to do so is often shorter and simpler than you’d expect.

More information here: https://stedolan.github.io/jq/

===== Kali Linux

[horizontal]
Install ntpdate package:: sudo apt-get install ntpdate
Sync date & time with ntp source:: sudo ntpdate in.pool.ntp.org
Install all the tools on Kali:: sudo apt-get install kali-linux-full
Kali Tools Listing:: https://en.kali.tools/all/
Update Kali:: sudo apt-get update; sudo apt-get dist-upgrade;sudo apt-get clean

===== LinEnum
Linux enumeration & privilege escalation checks

Link: https://github.com/rebootuser/LinEnum



===== Mentalist
Mentalist is a graphical tool for custom wordlist generation. It utilizes common human paradigms for constructing passwords and can output the full wordlist as well as rules compatible with Hashcat and John the Ripper.
Link: https://github.com/sc0tfree/mentalist/blob/master/README.md

===== Metasploit

[horizontal]
On Kali metasploit is in this directory:: /usr/share/metssploit-framework
To Update metasploit:: apt update; apt install metasploit-framework
Metasploit Online Database:: https://www.rapid7.com/db/modules

===== Mimikatz
Mimikatz is a leading post-exploitation tool that dumps passwords from memory, as well as hashes, PINs and Kerberos tickets. Other useful attacks it enables are pass-the-hash, pass-the-ticket or building Golden Kerberos tickets. This makes post-exploitation lateral movement within a network easy for attackers.

Link: https://github.com/gentilkiwi/mimikatz



===== Nikto
Nikto is an Open Source (GPL) web server scanner which performs comprehensive tests against web servers for multiple items, including over 6700 potentially dangerous files/programs, checks for outdated versions of over 1250 servers, and version specific problems on over 270 servers. It also checks for server configuration items such as the presence of multiple index files, HTTP server options, and will attempt to identify installed web servers and software. Scan items and plugins are frequently updated and can be automatically updated.

Nikto is not designed as a stealthy tool. It will test a web server in the quickest time possible, and is obvious in log files or to an IPS/IDS. However, there is support for LibWhisker's anti-IDS methods in case you want to give it a try (or test your IDS system).


Not every check is a security problem, though most are. There are some items that are "info only" type checks that look for things that may not have a security flaw, but the webmaster or security engineer may not know are present on the server. These items are usually marked appropriately in the information printed. There are also some checks for unknown items which have been seen scanned for in log files.

https://cirt.net/Nikto2 

===== Powershell Empire
Empire has an inbuilt listener named http_hop which allows us to redirect our traffic to one of our another active listener after getting an agent. Thus, the name hop as it hops the agent from one listener to another in order to redirect traffic.

Similar to Metasploit, the hop listener in empire uses a hop.php file. When you activate the hop listener, it will generate three PHP files that will redirect your existing listener. Place the said files in your jump server (ubuntu) and then set up your stager in according to get the session through the mediator i.e. our hop listener.
Link: https://www.hackingarticles.in/hiding-ip-during-pentest-using-powershell-empire-http_hop/

===== Pupy
Pupy is a cross-platform, post exploitation tool as well as a multi-function RAT. It’s written in python which makes it very convenient. It also has low detectability that’s why it’s a great tool for the red team.  Pupy can communicate using multiple transports, migrate into processes using reflective injection, and load remote python code, python packages and python C-extensions from memory.

It uses a reflected DLL to load python interpreter from memory which is great as nothing will be shown in the disk. It doesn’t have any special dependencies. It can also migrate into other processes. The communication protocols of pupy are modular and stackable. It can execute non-interactive commands on multiple hosts at once. All the interactive shells can be accessed remotely.
Link: https://www.hackingarticles.in/command-control-tool-pupy/

===== Responder
This tool is first an LLMNR and NBT-NS responder, it will answer to *specific* NBT-NS (NetBIOS Name Service) queries based on their name suffix (see: http://support.microsoft.com/kb/163409). By default, the tool will only answers to File Server Service request, which is for SMB. The concept behind this, is to target our answers, and be stealthier on the network. This also helps to ensure that we don’t break legitimate NBT-NS behavior. You can set the -r option to 1 via command line if you want this tool to answer to the Workstation Service request name suffix.

Usage Example
Specify the IP address to redirect to (-i 192.168.1.202), enabling the WPAD rogue proxy (-w On), answers for netbios wredir (-r On), and fingerprinting (-f On):

	responder -i 192.168.1.202 -w On -r On -f On

===== Sbmclient

===== Sharp Cookie Monster

If you steal a users Chrome cookie, you can log into their accounts on every website they are logged into.

Normally you need the user’s password to do it, @mangopdf found a way to do it without the password. You just need to be able to execute code on their computer. It works by using Chrome’s Remote Debugging Protocol

This tool is based on Cookie Crimes module: https://github.com/defaultnamehere/cookie_crimes 

Link: https://www.blackhatethicalhacking.com/tools/sharp-cookie-monster/

===== Smbmap

===== SSLStrip

===== Sublist3r

Sublist3r is a python tool designed to enumerate subdomains of websites using OSINT. It helps penetration testers and bug hunters collect and gather subdomains for the domain they are targeting. Sublist3r enumerates subdomains using many search engines such as Google, Yahoo, Bing, Baidu, and Ask. Sublist3r also enumerates subdomains using Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS.

*Installation*
. Login as root
. Open a terminal session
. Change directory to /opt

	cd /opt

. Download the latest version from git

	git clone https://github.com/aboul3la/Sublist3r.git

. Change the directory to Sublist3r:

	cd Sublist3r

. Install the required dependencies:

	pip install -r requirements.txt

. Execute the sublist3r

	python sublist3r -h
	or
	./sublist3r.py -h 

[horizontal]
Source:: https://github.com/aboul3la/Sublist3r
Author:: Ahmed Aboul-Ela
License:: GPL-2+

===== TheHarvester

===== Tokenvator
A Tool to Elevate Privilege using Windows Tokens

Link: https://blog.netspi.com/tokenvator-a-tool-to-elevate-privilege-using-windows-tokens/

===== TruffleHog

Link: https://github.com/dxa4481/truffleHog

===== Wfuzz
Wfuzz is a tool designed for bruteforcing Web Applications, it can be used for finding resources not linked (directories, servlets, scripts, etc), bruteforce GET and POST parameters for checking different kind of injections (SQL, XSS, LDAP,etc), bruteforce Forms parameters (User/Password), Fuzzing,etc.

[horizontal]
Source:: https://github.com/xmendez/wfuzz/
Author:: Christian Martorella, Carlos del ojo, Xavier Mendez aka Javi
License:: GPLv2

===== Yara